/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
define("vs/css!vs/workbench/parts/git/browser/media/gitViewlet",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/css!vs/workbench/parts/git/browser/views/changes/changesView",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/css!vs/workbench/parts/git/browser/views/disabled/disabledView",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/css!vs/workbench/parts/git/browser/views/empty/emptyView",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/css!vs/workbench/parts/git/browser/views/gitless/gitlessView",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/css!vs/workbench/parts/git/browser/views/notroot/notrootView",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/css!vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView",["vs/css!vs/workbench/parts/git/browser/gitViewlet"],{}),define("vs/nls!vs/workbench/parts/git/browser/views/changes/changesView",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/changes/changesView",e)}),define("vs/nls!vs/workbench/parts/git/browser/views/changes/changesViewer",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/changes/changesViewer",e)}),define("vs/nls!vs/workbench/parts/git/browser/views/disabled/disabledView",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/disabled/disabledView",e)}),define("vs/nls!vs/workbench/parts/git/browser/views/empty/emptyView",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/empty/emptyView",e)}),define("vs/nls!vs/workbench/parts/git/browser/views/gitless/gitlessView",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/gitless/gitlessView",e)}),define("vs/nls!vs/workbench/parts/git/browser/views/notroot/notrootView",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/notroot/notrootView",e)}),define("vs/nls!vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView",["vs/nls","vs/nls!vs/workbench/parts/git/browser/gitViewlet"],function(t,e){return t.create("vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView",e)});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define("vs/workbench/parts/git/browser/views/disabled/disabledView",["require","exports","vs/nls!vs/workbench/parts/git/browser/views/disabled/disabledView","vs/base/common/winjs.base","vs/base/common/eventEmitter","vs/base/browser/builder","vs/platform/selection/common/selection","vs/css!./disabledView"],function(t,e,n,r,i,o,s){var a=o.$,c=function(t){function e(){t.apply(this,arguments),this.ID="disabled"}return __extends(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){this._element=a(['<div class="disabled-view">',"<p>",n.localize(0,null),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return r.Promise.as(null)},e.prototype.getSelection=function(){return s.Selection.EMPTY},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e}(i.EventEmitter);e.DisabledView=c});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__decorate=this&&this.__decorate||function(t,e,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,r);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,r){return void(r&&r(e,n))},void 0);case 4:return t.reduceRight(function(t,r){return r&&r(e,n,t)||t},r)}},__param=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}};define("vs/workbench/parts/git/browser/views/gitless/gitlessView",["require","exports","vs/nls!vs/workbench/parts/git/browser/views/gitless/gitlessView","vs/base/common/platform","vs/base/common/winjs.base","vs/base/common/eventEmitter","vs/base/browser/builder","vs/platform/workspace/common/workspace","vs/platform/selection/common/selection","vs/css!./gitlessView"],function(t,e,n,r,i,o,s,a,c){var u=s.$,l=function(t){function e(e){t.call(this),this.ID="gitless",this._contextService=e}return __extends(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t;t=r.isMacintosh?n.localize(0,null,'<a href="http://brew.sh/" target="_blank">Homebrew</a>','<a href="http://git-scm.com/download/mac" target="_blank">git-scm.com</a>','<a href="https://developer.apple.com/xcode/" target="_blank">XCode</a>',"<code>git</code>"):r.isWindows?n.localize(1,null,'<a href="https://chocolatey.org/packages/git" target="_blank">Chocolatey</a>','<a href="http://git-scm.com/download/win" target="_blank">git-scm.com</a>'):r.isLinux?n.localize(2,null,'<a href="http://git-scm.com/download/linux" target="_blank">git-scm.com</a>'):n.localize(3,null,'<a href="http://git-scm.com/download" target="_blank">git-scm.com</a>'),this._element=u(['<div class="gitless-view">',"<p>",n.localize(4,null),"</p>","<p>",t,"</p>","<p>",n.localize(5,null,this._contextService.getConfiguration().env.appName),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return i.Promise.as(null)},e.prototype.getSelection=function(){return c.Selection.EMPTY},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e=__decorate([__param(0,a.IWorkspaceContextService)],e)}(o.EventEmitter);e.GitlessView=l});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define("vs/workbench/parts/git/browser/views/notroot/notrootView",["require","exports","vs/nls!vs/workbench/parts/git/browser/views/notroot/notrootView","vs/base/common/winjs.base","vs/base/common/eventEmitter","vs/base/browser/builder","vs/platform/selection/common/selection","vs/css!./notrootView"],function(t,e,n,r,i,o,s){var a=o.$,c=function(t){function e(){t.apply(this,arguments),this.ID="notroot"}return __extends(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){this._element=a(['<div class="notroot-view">',"<p>",n.localize(0,null),"</p>","<p>",n.localize(1,null),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return r.Promise.as(null)},e.prototype.getSelection=function(){return s.Selection.EMPTY},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e}(i.EventEmitter);e.NotRootView=c});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define("vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView",["require","exports","vs/nls!vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView","vs/base/common/winjs.base","vs/base/common/eventEmitter","vs/base/browser/builder","vs/platform/selection/common/selection","vs/css!./noworkspaceView"],function(t,e,n,r,i,o,s){var a=o.$,c=function(t){function e(){t.apply(this,arguments),this.ID="noworkspace"}return __extends(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){this._element=a(['<div class="noworkspace-view">',"<p>",n.localize(0,null),"</p>","<p>",n.localize(1,null),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return r.Promise.as(null)},e.prototype.getSelection=function(){return s.Selection.EMPTY},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e}(i.EventEmitter);e.NoWorkspaceView=c});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__decorate=this&&this.__decorate||function(t,e,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,r);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,r){return void(r&&r(e,n))},void 0);case 4:return t.reduceRight(function(t,r){return r&&r(e,n,t)||t},r)}},__param=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}};define("vs/workbench/parts/git/browser/views/changes/changesViewer",["require","exports","vs/base/common/winjs.base","vs/nls!vs/workbench/parts/git/browser/views/changes/changesViewer","vs/base/common/platform","vs/base/common/paths","vs/base/common/severity","vs/base/browser/dom","vs/base/common/comparers","vs/base/browser/ui/actionbar/actionbar","vs/base/browser/ui/countBadge/countBadge","vs/base/parts/tree/common/tree","vs/base/parts/tree/browser/treeDnd","vs/base/parts/tree/browser/treeDefaults","vs/workbench/parts/git/common/git","vs/workbench/parts/git/common/gitModel","vs/workbench/parts/git/browser/gitActions","vs/platform/contextview/browser/contextView","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/base/common/keyCodes","vs/platform/workspace/common/workspace","vs/base/common/uri"],function(t,e,n,r,i,o,s,a,c,u,l,p,h,f,v,g,d,m,w,S,y,b,E){function _(t){return i.isWindows?t.replace(/\//g,"\\"):t}var D=v.IGitService,I=a.emmet,T=function(){function t(t){this.cache={},this.instantiationService=t}return t.prototype.getAction=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.cache[t.ID];return r||(e.unshift(t),r=this.cache[t.ID]=this.instantiationService.createInstance.apply(this.instantiationService,e)),r},t.prototype.dispose=function(){var t=this;Object.keys(this.cache).forEach(function(e){t.cache[e].dispose()}),this.cache=null},t}();e.ActionContainer=T;var R=function(){function t(){}return t.prototype.getId=function(t,e){if(e instanceof g.StatusModel)return"root";if(e instanceof g.StatusGroup){var n=e;switch(n.getType()){case v.StatusType.INDEX:return"index";case v.StatusType.WORKING_TREE:return"workingTree";case v.StatusType.MERGE:return"merge";default:throw new Error("Invalid group type")}}var r=e;return r.getId()},t.prototype.hasChildren=function(t,e){if(e instanceof g.StatusModel)return!0;if(e instanceof g.StatusGroup){var n=e;return n.all().length>0}},t.prototype.getChildren=function(t,e){if(e instanceof g.StatusModel){var r=e;return n.Promise.as(r.getGroups())}if(e instanceof g.StatusGroup){var i=e;return n.Promise.as(i.all())}return n.Promise.as([])},t.prototype.getParent=function(t,e){return n.Promise.as(null)},t}();e.DataSource=R;var A=function(t){function e(e,n){t.call(this,e),this.gitService=n}return __extends(e,t),e.prototype.hasActions=function(t,e){return e instanceof g.FileStatus?!0:e instanceof g.StatusGroup&&e.all().length>0?!0:!1},e.prototype.getActions=function(t,e){return e instanceof g.StatusGroup?n.Promise.as(this.getActionsForGroupStatusType(e.getType())):n.Promise.as(this.getActionsForFileStatusType(e.getType()))},e.prototype.getActionsForFileStatusType=function(t){switch(t){case v.StatusType.INDEX:return[this.getAction(d.UnstageAction)];case v.StatusType.WORKING_TREE:return[this.getAction(d.UndoAction),this.getAction(d.StageAction)];case v.StatusType.MERGE:return[this.getAction(d.StageAction)];default:return[]}},e.prototype.getActionsForGroupStatusType=function(t){switch(t){case v.StatusType.INDEX:return[this.getAction(d.GlobalUnstageAction)];case v.StatusType.WORKING_TREE:return[this.getAction(d.GlobalUndoAction),this.getAction(d.GlobalStageAction)];case v.StatusType.MERGE:return[this.getAction(d.StageAction)];default:return[]}},e.prototype.hasSecondaryActions=function(t,e){return this.hasActions(t,e)},e.prototype.getSecondaryActions=function(t,e){var n=this;return this.getActions(t,e).then(function(t){if(e instanceof g.FileStatus){var r=e,i=r.getStatus();t.push(new u.Separator),i!==v.Status.DELETED&&i!==v.Status.INDEX_DELETED&&t.push(n.getAction(d.OpenFileAction)),t.push(n.getAction(d.OpenChangeAction))}return t.reverse(),t})},e.prototype.getActionItem=function(t,e,n){return null},e=__decorate([__param(0,w.IInstantiationService),__param(1,D)],e)}(T);e.ActionProvider=A;var V=function(){function t(t,e,n,r,i){this.actionProvider=t,this.actionRunner=e,this.messageService=n,this.gitService=r,this.contextService=i}return t.prototype.getHeight=function(t,e){return 24},t.prototype.getTemplateId=function(t,e){if(e instanceof g.StatusGroup)switch(e.getType()){case v.StatusType.INDEX:return"index";case v.StatusType.WORKING_TREE:return"workingTree";case v.StatusType.MERGE:return"merge"}if(e instanceof g.FileStatus)switch(e.getType()){case v.StatusType.INDEX:return"file:index";case v.StatusType.WORKING_TREE:return"file:workingTree";case v.StatusType.MERGE:return"file:merge"}return null},t.prototype.renderTemplate=function(e,n,r){return/^file:/.test(n)?this.renderFileStatusTemplate(t.templateIdToStatusType(n),r):this.renderStatusGroupTemplate(t.templateIdToStatusType(n),r)},t.prototype.renderStatusGroupTemplate=function(t,e){var n=this,i=Object.create(null);switch(i.actionBar=new u.ActionBar(e,{actionRunner:this.actionRunner}),i.actionBar.push(this.actionProvider.getActionsForGroupStatusType(t),{icon:!0,label:!1}),i.actionBar.addListener2("run",function(t){return t.error&&n.onError(t.error)}),i.count=new l.CountBadge(e),i.root=a.append(e,I(".status-group")),t){case v.StatusType.INDEX:i.root.textContent=r.localize(0,null);break;case v.StatusType.WORKING_TREE:i.root.textContent=r.localize(1,null);break;case v.StatusType.MERGE:i.root.textContent=r.localize(2,null)}return i},t.prototype.renderFileStatusTemplate=function(t,e){var n=this,r=Object.create(null);r.actionBar=new u.ActionBar(e,{actionRunner:this.actionRunner}),r.actionBar.push(this.actionProvider.getActionsForFileStatusType(t),{icon:!0,label:!1}),r.actionBar.addListener2("run",function(t){return t.error&&n.onError(t.error)}),r.root=a.append(e,I(".file-status")),r.status=a.append(r.root,I("span.status")),r.name=a.append(r.root,I("a.name.plain")),r.folder=a.append(r.root,I("span.folder"));var i=a.append(r.root,I("span.rename")),o=a.append(i,I("span.rename-arrow"));return o.textContent="←",r.renameName=a.append(i,I("span.rename-name")),r.renameFolder=a.append(i,I("span.rename-folder")),r},t.prototype.renderElement=function(e,n,r,i){/^file:/.test(r)?this.renderFileStatus(e,n,i):t.renderStatusGroup(n,i)},t.renderStatusGroup=function(t,e){e.actionBar.context=t,e.count.setCount(t.all().length)},t.prototype.renderFileStatus=function(e,n,i){i.actionBar.context={tree:e,fileStatus:n};var s=this.gitService.getModel().getRepositoryRoot(),a=this.contextService.getWorkspace().resource.fsPath,c=n.getStatus(),u=n.getRename(),l=n.getPath(),p=l.lastIndexOf("/"),h=-1===p?l:l.substr(p+1,l.length),f=-1===p?"":l.substr(0,p);i.root.className="file-status "+t.statusToClass(c),i.status.textContent=t.statusToChar(c),i.status.title=t.statusToTitle(c);var v=E["default"].file(o.normalize(o.join(s,l))),g=o.isEqualOrParent(v.fsPath,a),d="",m="";if(u){var w=u.lastIndexOf("/");d=-1===w?u:u.substr(w+1,u.length),m=-1===w?"":u.substr(0,w),i.renameName.textContent=h,i.renameFolder.textContent=f;var S=E["default"].file(o.normalize(o.join(s,u)));g=o.isEqualOrParent(S.fsPath,a)}g?i.root.title="":(i.root.title=r.localize(3,null),i.root.className+=" out-of-workspace"),i.name.textContent=d||h,i.folder.textContent=_(m||f)},t.prototype.disposeTemplate=function(e,n,r){/^file:/.test(n)&&t.disposeFileStatusTemplate(r)},t.disposeFileStatusTemplate=function(t){t.actionBar.dispose()},t.statusToChar=function(t){switch(t){case v.Status.INDEX_MODIFIED:return r.localize(4,null);case v.Status.MODIFIED:return r.localize(5,null);case v.Status.INDEX_ADDED:return r.localize(6,null);case v.Status.INDEX_DELETED:return r.localize(7,null);case v.Status.DELETED:return r.localize(8,null);case v.Status.INDEX_RENAMED:return r.localize(9,null);case v.Status.INDEX_COPIED:return r.localize(10,null);case v.Status.UNTRACKED:return r.localize(11,null);case v.Status.IGNORED:return r.localize(12,null);case v.Status.BOTH_DELETED:return r.localize(13,null);case v.Status.ADDED_BY_US:return r.localize(14,null);case v.Status.DELETED_BY_THEM:return r.localize(15,null);case v.Status.ADDED_BY_THEM:return r.localize(16,null);case v.Status.DELETED_BY_US:return r.localize(17,null);case v.Status.BOTH_ADDED:return r.localize(18,null);case v.Status.BOTH_MODIFIED:return r.localize(19,null);default:return""}},t.statusToTitle=function(t){switch(t){case v.Status.INDEX_MODIFIED:return r.localize(20,null);case v.Status.MODIFIED:return r.localize(21,null);case v.Status.INDEX_ADDED:return r.localize(22,null);case v.Status.INDEX_DELETED:return r.localize(23,null);case v.Status.DELETED:return r.localize(24,null);case v.Status.INDEX_RENAMED:return r.localize(25,null);case v.Status.INDEX_COPIED:return r.localize(26,null);case v.Status.UNTRACKED:return r.localize(27,null);case v.Status.IGNORED:return r.localize(28,null);case v.Status.BOTH_DELETED:return r.localize(29,null);case v.Status.ADDED_BY_US:return r.localize(30,null);case v.Status.DELETED_BY_THEM:return r.localize(31,null);case v.Status.ADDED_BY_THEM:return r.localize(32,null);case v.Status.DELETED_BY_US:return r.localize(33,null);case v.Status.BOTH_ADDED:return r.localize(34,null);case v.Status.BOTH_MODIFIED:return r.localize(35,null);default:return""}},t.statusToClass=function(t){switch(t){case v.Status.INDEX_MODIFIED:return"modified";case v.Status.MODIFIED:return"modified";case v.Status.INDEX_ADDED:return"added";case v.Status.INDEX_DELETED:return"deleted";case v.Status.DELETED:return"deleted";case v.Status.INDEX_RENAMED:return"renamed";case v.Status.INDEX_COPIED:return"copied";case v.Status.UNTRACKED:return"untracked";case v.Status.IGNORED:return"ignored";case v.Status.BOTH_DELETED:return"conflict both-deleted";case v.Status.ADDED_BY_US:return"conflict added-by-us";case v.Status.DELETED_BY_THEM:return"conflict deleted-by-them";case v.Status.ADDED_BY_THEM:return"conflict added-by-them";case v.Status.DELETED_BY_US:return"conflict deleted-by-us";case v.Status.BOTH_ADDED:return"conflict both-added";case v.Status.BOTH_MODIFIED:return"conflict both-modified";default:return""}},t.templateIdToStatusType=function(t){return/index$/.test(t)?v.StatusType.INDEX:/workingTree$/.test(t)?v.StatusType.WORKING_TREE:v.StatusType.MERGE},t.prototype.onError=function(t){this.messageService.show(s["default"].Error,t)},t=__decorate([__param(2,S.IMessageService),__param(3,D),__param(4,b.IWorkspaceContextService)],t)}();e.Renderer=V;var O=function(){function t(){}return t.prototype.isVisible=function(t,e){if(e instanceof g.StatusGroup){var n=e;switch(n.getType()){case v.StatusType.INDEX:case v.StatusType.MERGE:return n.all().length>0;case v.StatusType.WORKING_TREE:return!0}}return!0},t}();e.Filter=O;var k=function(){function t(){}return t.prototype.compare=function(e,n,r){return n instanceof g.FileStatus&&r instanceof g.FileStatus?t.compareStatus(n,r):0},t.compareStatus=function(t,e){for(var n,r,i,o,s=t.getPathComponents(),a=e.getPathComponents(),u=s.length-1,l=a.length-1,p=0;;p++){if(n=u===p,r=l===p,n&&r)return c.compareFileNames(s[p],a[p]);if(n)return-1;if(r)return 1;if((i=s[p].toLowerCase())!==(o=a[p].toLowerCase()))return o>i?-1:1}},t}();e.Sorter=k;var C=function(t){function e(e,n,r){t.call(this,e),this.gitService=n,this.messageService=r}return __extends(e,t),e.prototype.getDragURI=function(t,e){if(e instanceof g.StatusGroup){var n=e;return"git:"+n.getType()}if(e instanceof g.FileStatus){var r=e;return"git:"+r.getType()+":"+r.getPath()}return null},e.prototype.onDragStart=function(t,e,n){},e.prototype.onDragOver=function(t,e,n,r){if(!this.gitService.isIdle())return p.DRAG_OVER_REJECT;if(!(e instanceof h.ElementsDragAndDropData))return p.DRAG_OVER_REJECT;var i=e.getData(),o=i[0];if(o instanceof g.StatusGroup){var s=o;return this.onDrag(n,s.getType())}if(o instanceof g.FileStatus){var a=o;return this.onDrag(n,a.getType())}return p.DRAG_OVER_REJECT},e.prototype.onDrag=function(t,e){return e===v.StatusType.WORKING_TREE?this.onDragWorkingTree(t):e===v.StatusType.INDEX?this.onDragIndex(t):e===v.StatusType.MERGE?this.onDragMerge(t):p.DRAG_OVER_REJECT},e.prototype.onDragWorkingTree=function(t){if(t instanceof g.StatusGroup){var e=t;return e.getType()===v.StatusType.INDEX?p.DRAG_OVER_ACCEPT_BUBBLE_DOWN:p.DRAG_OVER_REJECT}if(t instanceof g.FileStatus){var n=t;return n.getType()===v.StatusType.INDEX?p.DRAG_OVER_ACCEPT_BUBBLE_UP:p.DRAG_OVER_REJECT}return p.DRAG_OVER_REJECT},e.prototype.onDragIndex=function(t){if(t instanceof g.StatusGroup){var e=t;return e.getType()===v.StatusType.WORKING_TREE?p.DRAG_OVER_ACCEPT_BUBBLE_DOWN:p.DRAG_OVER_REJECT}if(t instanceof g.FileStatus){var n=t;return n.getType()===v.StatusType.WORKING_TREE?p.DRAG_OVER_ACCEPT_BUBBLE_UP:p.DRAG_OVER_REJECT}return p.DRAG_OVER_REJECT},e.prototype.onDragMerge=function(t){if(t instanceof g.StatusGroup){var e=t;return e.getType()===v.StatusType.INDEX?p.DRAG_OVER_ACCEPT_BUBBLE_DOWN:p.DRAG_OVER_REJECT}if(t instanceof g.FileStatus){var n=t;return n.getType()===v.StatusType.INDEX?p.DRAG_OVER_ACCEPT_BUBBLE_UP:p.DRAG_OVER_REJECT}return p.DRAG_OVER_REJECT},e.prototype.drop=function(t,e,n,r){var i,o=this,s=e.getData(),a=s[0];i=a instanceof g.StatusGroup?a.all():s;var c=n;c.getType()===v.StatusType.INDEX&&this.getAction(d.StageAction).run(i).done(null,function(t){return o.onError(t)}),c.getType()===v.StatusType.WORKING_TREE&&this.getAction(d.UnstageAction).run(i).done(null,function(t){return o.onError(t)})},e.prototype.onError=function(t){this.messageService.show(s["default"].Error,t)},e=__decorate([__param(0,w.IInstantiationService),__param(1,D),__param(2,S.IMessageService)],e)}(T);e.DragAndDrop=C;var x=function(t){function e(e,n){t.call(this,{clickBehavior:f.ClickBehavior.ON_MOUSE_UP}),this.actionProvider=e,this.contextMenuService=n,this.downKeyBindingDispatcher.set(y.CommonKeybindings.SHIFT_UP_ARROW,this.onUp.bind(this)),this.downKeyBindingDispatcher.set(y.CommonKeybindings.SHIFT_DOWN_ARROW,this.onDown.bind(this)),this.downKeyBindingDispatcher.set(y.CommonKeybindings.SHIFT_PAGE_UP,this.onPageUp.bind(this)),this.downKeyBindingDispatcher.set(y.CommonKeybindings.SHIFT_PAGE_DOWN,this.onPageDown.bind(this))}return __extends(e,t),e.prototype.onLeftClick=function(e,n,r){if(n instanceof g.StatusGroup)return r.preventDefault(),r.stopPropagation(),!0;if(r.shiftKey){var o=e.getFocus();if(!o||o instanceof g.StatusGroup)return;var s=o,a=n;if(s.getType()!==a.getType())return;return void(this.canSelect(e,n)&&(e.setFocus(n),e.isSelected(n)?e.deselectRange(s,a):e.selectRange(s,a)))}return e.setFocus(n),(i.isMacintosh?r.metaKey:r.ctrlKey)?void(this.canSelect(e,n)&&e.toggleSelection(n,{origin:"mouse",originalEvent:r})):t.prototype.onLeftClick.call(this,e,n,r)},e.prototype.onEnter=function(e,n){var r=e.getFocus();return r instanceof g.StatusGroup?(n.preventDefault(),n.stopPropagation(),!0):t.prototype.onEnter.call(this,e,n)},e.prototype.onSpace=function(t,e){var n=t.getFocus();return n?this.canSelect(t,n)?(t.toggleSelection(n,{origin:"keyboard",originalEvent:e}),e.preventDefault(),e.stopPropagation(),!0):!1:(e.preventDefault(),e.stopPropagation(),!0)},e.prototype.onContextMenu=function(t,e,n){var r=this;if(n.target&&n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!1;if(n.preventDefault(),n.stopPropagation(),t.setFocus(e),this.actionProvider.hasSecondaryActions(t,e)){var i={x:n.posx+1,y:n.posy},o={selection:t.getSelection(),focus:e};return this.contextMenuService.showContextMenu({getAnchor:function(){return i},getActions:function(){return r.actionProvider.getSecondaryActions(t,e)},getActionItem:this.actionProvider.getActionItem.bind(this.actionProvider,t,e),getActionsContext:function(){return o},onHide:function(e){e&&t.DOMFocus()}}),!0}return!1},e.prototype.onLeft=function(t,e){return!0},e.prototype.onRight=function(t,e){return!0},e.prototype.onUp=function(e,n){var r=e.getFocus(),i=t.prototype.onUp.call(this,e,n);return i&&n.shiftKey?this.shiftSelect(e,r,n):!1},e.prototype.onPageUp=function(e,n){var r=e.getFocus(),i=t.prototype.onPageUp.call(this,e,n);return i&&n.shiftKey?this.shiftSelect(e,r,n):!1},e.prototype.onDown=function(e,n){var r=e.getFocus(),i=t.prototype.onDown.call(this,e,n);return i&&n.shiftKey?this.shiftSelect(e,r,n):!1},e.prototype.onPageDown=function(e,n){var r=e.getFocus(),i=t.prototype.onPageDown.call(this,e,n);return i&&n.shiftKey?this.shiftSelect(e,r,n):!1},e.prototype.canSelect=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some(function(t){return t instanceof g.StatusGroup||t instanceof g.StatusModel})?!1:e.every(function(e){var n=t.getSelection()[0],r=e;return!n||n.getType()===r.getType()})},e.prototype.shiftSelect=function(t,e,n){var r={origin:"keyboard",originalEvent:n},i=t.getFocus();if(i===e)return!1;var o=t.isSelected(e),s=t.isSelected(i);return o&&s?t.deselectRange(i,e,r):o||s?o?this.canSelect(t,i)&&t.selectRange(i,e,r):t.deselectRange(i,e,r):this.canSelect(t,e,i)&&t.selectRange(i,e,r),!0},e=__decorate([__param(1,m.IContextMenuService)],e)}(f.DefaultController);e.Controller=x});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__decorate=this&&this.__decorate||function(t,e,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,r);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,r){return void(r&&r(e,n))},void 0);case 4:return t.reduceRight(function(t,r){return r&&r(e,n,t)||t},r)}},__param=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}};define("vs/workbench/parts/git/browser/views/changes/changesView",["require","exports","vs/nls!vs/workbench/parts/git/browser/views/changes/changesView","vs/base/common/platform","vs/base/common/lifecycle","vs/base/common/eventEmitter","vs/base/common/strings","vs/base/common/errors","vs/base/common/paths","vs/base/common/winjs.base","vs/base/browser/builder","vs/base/browser/keyboardEvent","vs/base/common/actions","vs/base/browser/ui/actionbar/actionbar","vs/base/parts/tree/browser/treeImpl","vs/workbench/browser/events","vs/workbench/parts/git/common/git","vs/workbench/parts/git/browser/gitActions","vs/workbench/parts/git/common/gitModel","vs/workbench/parts/git/browser/views/changes/changesViewer","vs/workbench/parts/git/browser/gitEditorInputs","vs/workbench/parts/files/common/files","vs/workbench/parts/output/common/output","vs/workbench/common/editor","vs/base/browser/ui/inputbox/inputBox","vs/base/common/severity","vs/workbench/services/editor/common/editorService","vs/platform/contextview/browser/contextView","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/platform/workspace/common/workspace","vs/platform/selection/common/selection","vs/platform/event/common/event","vs/base/common/keyCodes","vs/css!./changesView"],function(t,e,n,r,i,o,s,a,c,u,l,p,h,f,v,g,d,m,w,S,y,b,E,_,D,I,T,R,A,V,O,k,C,x){var P=d.IGitService,G=l.$,M=function(t){function e(e,n,r,i,o,s,c,u,l){var p=this;t.call(this),this.ID="changes",this.instantiationService=n,this.editorService=r,this.messageService=i,this.contextViewService=o,this.contextService=s,this.gitService=c,this.outputService=u,this.visible=!1,this.currentDimension=null,this.actionRunner=e,this.toDispose=[this.smartCommitAction=this.instantiationService.createInstance(m.SmartCommitAction,this),l.addListener2(g.EventType.EDITOR_INPUT_CHANGED,function(t){return p.onEditorInputChanged(t.editorInput).done(null,a.onUnexpectedError)}),this.gitService.addListener2(d.ServiceEvents.OPERATION_START,function(t){return p.onGitOperationStart(t)}),this.gitService.addListener2(d.ServiceEvents.OPERATION_END,function(t){return p.onGitOperationEnd(t)}),this.gitService.getModel().addListener2(d.ModelEvents.MODEL_UPDATED,this.onGitModelUpdate.bind(this))]}return __extends(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this.render(),this.$el.getHTMLElement()},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this;if(!this.$el){this.$el=G(".changes-view"),this.$commitView=G(".commit-view").appendTo(this.$el),this.commitInputBox=new D.InputBox(this.$commitView.getHTMLElement(),this.contextViewService,{placeholder:n.localize(2,null,e.COMMIT_KEYBINDING),validationOptions:{showMessage:!0,validation:function(){return null}},flexibleHeight:!0}),this.addEmitter2(this.commitInputBox,"commitInputBox"),G(this.commitInputBox.inputElement).on("keydown",function(n){var r=new p.StandardKeyboardEvent(n);(r.equals(x.CommonKeybindings.CTRLCMD_ENTER)||r.equals(x.CommonKeybindings.CTRLCMD_S))&&(t.smartCommitAction.enabled?t.actionRunner.run(t.smartCommitAction).done():t.commitInputBox.showMessage({content:e.NOTHING_TO_COMMIT,formatContent:!0,type:D.MessageType.INFO}))}).on("blur",function(){t.commitInputBox.hideMessage()}),this.$statusView=G(".status-view").appendTo(this.$el);var r=this.instantiationService.createInstance(S.ActionProvider),i=this.instantiationService.createInstance(S.Renderer,r,this.actionRunner),o=this.instantiationService.createInstance(S.DragAndDrop),s=this.instantiationService.createInstance(S.Controller,r);this.tree=new v.Tree(this.$statusView.getHTMLElement(),{dataSource:new S.DataSource,renderer:i,filter:new S.Filter,sorter:new S.Sorter,dnd:o,controller:s},{indentPixels:0,twistiePixels:20}),this.tree.setInput(this.gitService.getModel().getStatus()),this.tree.expandAll(this.gitService.getModel().getStatus().getGroups()),this.toDispose.push(this.tree.addListener2("selection",function(e){return t.onSelection(e)})),this.toDispose.push(this.commitInputBox.addListener2("heightchange",function(){return t.layout()}))}},e.prototype.focus=function(){var t=this.tree.getSelection();t.length>0&&this.tree.reveal(t[0],.5).done(null,a.onUnexpectedError),this.commitInputBox.focus()},e.prototype.layout=function(t){if(void 0===t&&(t=this.currentDimension),t){this.currentDimension=t,this.commitInputBox.layout();var e=t.height-(this.commitInputBox.height+10);this.$statusView.size(t.width,e),this.tree.layout(e),134===this.commitInputBox.height?this.$commitView.addClass("scroll"):this.$commitView.removeClass("scroll")}},e.prototype.setVisible=function(t){return this.visible=t,t?(this.tree.onVisible(),this.onEditorInputChanged(this.editorService.getActiveEditorInput())):(this.tree.onHidden(),u.Promise.as(null));
},e.prototype.getSelection=function(){return new k.StructuredSelection(this.tree.getSelection())},e.prototype.getControl=function(){return this.tree},e.prototype.getActions=function(){var t=this;return this.actions||(this.actions=[this.smartCommitAction,this.instantiationService.createInstance(m.RefreshAction)],this.actions.forEach(function(e){return t.toDispose.push(e)})),this.actions},e.prototype.getSecondaryActions=function(){var t=this;return this.secondaryActions||(this.secondaryActions=[this.instantiationService.createInstance(m.SyncAction,m.SyncAction.ID,m.SyncAction.LABEL),this.instantiationService.createInstance(m.PullAction,m.PullAction.ID,m.PullAction.LABEL),this.instantiationService.createInstance(m.PullWithRebaseAction),this.instantiationService.createInstance(m.PushAction,m.PushAction.ID,m.PushAction.LABEL),new f.Separator,this.instantiationService.createInstance(m.PublishAction,m.PublishAction.ID,m.PublishAction.LABEL),new f.Separator,this.instantiationService.createInstance(m.CommitAction,this),this.instantiationService.createInstance(m.StageAndCommitAction,this),this.instantiationService.createInstance(m.UndoLastCommitAction),new f.Separator,this.instantiationService.createInstance(m.GlobalUnstageAction),this.instantiationService.createInstance(m.GlobalUndoAction),new f.Separator,new h.Action("show.gitOutput",n.localize(3,null),null,!0,function(){return t.outputService.showOutput("Git")})],this.secondaryActions.forEach(function(e){return t.toDispose.push(e)})),this.secondaryActions},e.prototype.getCommitMessage=function(){return s.trim(this.commitInputBox.value)},e.prototype.onEmptyCommitMessage=function(){this.commitInputBox.focus(),this.commitInputBox.showMessage({content:e.NEED_MESSAGE,formatContent:!0,type:D.MessageType.INFO})},e.prototype.onGitModelUpdate=function(){var t=this;this.tree&&this.tree.refresh().done(function(){return t.tree.expandAll(t.gitService.getModel().getStatus().getGroups())})},e.prototype.onEditorInputChanged=function(t){var e=this;if(!this.tree)return u.Promise.as(null);var n=this.getStatusFromInput(t);return n||(this.tree.clearSelection(),this.tree.clearFocus()),this.visible&&-1===this.tree.getSelection().indexOf(n)?this.tree.reveal(n,.5).then(function(){e.tree.setSelection([n],{origin:"implicit"}),e.tree.setFocus(n)}):u.Promise.as(null)},e.prototype.onSelection=function(t){var e=this;if(!(t.payload&&t.payload&&"implicit"===t.payload.origin||1!==t.selection.length)){var n=t.selection[0];if(n instanceof w.FileStatus&&(!t.payload||"keyboard"!==t.payload.origin||!t.payload.originalEvent.equals(x.CommonKeybindings.ENTER))){var r=t.payload&&"mouse"===t.payload.origin;if(!r||!t.payload.originalEvent.metaKey&&!t.payload.originalEvent.shiftKey){var i=n;this.gitService.getInput(i).done(function(n){var i=new _.TextDiffEditorOptions;if(r){i.preserveFocus=!0;var o=t&&t.payload&&"mouse"===t.payload.origin&&t.payload.originalEvent;o&&2===o.detail&&(i.preserveFocus=!1,o.preventDefault())}i.forceOpen=!0;var s=t&&t.payload&&t.payload.originalEvent&&t.payload.originalEvent.altKey;return e.editorService.openEditor(n,i,s)},function(t){return t.gitErrorCode===d.GitErrorCodes.CantOpenResource?void e.messageService.show(I["default"].Warning,t):void e.messageService.show(I["default"].Error,t)})}}}},e.prototype.onGitOperationStart=function(t){t.id===d.ServiceOperations.COMMIT&&this.commitInputBox&&this.commitInputBox.disable()},e.prototype.onGitOperationEnd=function(t){t.operation.id===d.ServiceOperations.COMMIT&&this.commitInputBox&&(this.commitInputBox.enable(),t.error||(this.commitInputBox.value=""))},e.prototype.getStatusFromInput=function(t){if(!t)return null;if(t instanceof y.GitDiffEditorInput)return t.getFileStatus();if(t instanceof y.NativeGitIndexStringEditorInput)return t.getFileStatus()||null;if(t instanceof b.FileEditorInput){var e=t,n=e.getResource(),r=this.contextService.getWorkspace().resource.fsPath;if(!c.isEqualOrParent(n.fsPath,r))return null;var i=this.gitService.getModel().getRepositoryRoot();if(!c.isEqualOrParent(n.fsPath,i))return null;var o=c.normalize(c.relative(i,n.fsPath)),s=this.gitService.getModel().getStatus().getWorkingTreeStatus().find(o);if(s&&(s.getStatus()===d.Status.UNTRACKED||s.getStatus()===d.Status.IGNORED))return s;if(s=this.gitService.getModel().getStatus().getMergeStatus().find(o))return s}return null},e.prototype.dispose=function(){this.$el&&(this.$el.dispose(),this.$el=null),this.toDispose=i.disposeAll(this.toDispose),t.prototype.dispose.call(this)},e.COMMIT_KEYBINDING=r.isMacintosh?"Cmd+Enter":"Ctrl+Enter",e.NEED_MESSAGE=n.localize(0,null,e.COMMIT_KEYBINDING),e.NOTHING_TO_COMMIT=n.localize(1,null,e.COMMIT_KEYBINDING),e=__decorate([__param(1,A.IInstantiationService),__param(2,T.IWorkbenchEditorService),__param(3,V.IMessageService),__param(4,R.IContextViewService),__param(5,O.IWorkspaceContextService),__param(6,P),__param(7,E.IOutputService),__param(8,C.IEventService)],e)}(o.EventEmitter);e.ChangesView=M});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__decorate=this&&this.__decorate||function(t,e,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,r);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,r){return void(r&&r(e,n))},void 0);case 4:return t.reduceRight(function(t,r){return r&&r(e,n,t)||t},r)}},__param=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}};define("vs/workbench/parts/git/browser/views/empty/emptyView",["require","exports","vs/nls!vs/workbench/parts/git/browser/views/empty/emptyView","vs/base/common/lifecycle","vs/base/common/eventEmitter","vs/base/browser/dom","vs/base/common/winjs.base","vs/base/browser/builder","vs/workbench/parts/git/common/git","vs/workbench/parts/git/browser/gitActions","vs/base/common/severity","vs/platform/files/common/files","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/platform/selection/common/selection","vs/css!./emptyView"],function(t,e,n,r,i,o,s,a,c,u,l,p,h,f,v){var g=c.IGitService,d=a.$,m=function(t){function e(e){var n=this;t.call(this),this.$el=d("a.button.clone").href("#").appendTo(e),this.$el.on("click",function(t){return n.enabled?void n.emit("click",t):void o.EventHelper.stop(t)})}return __extends(e,t),Object.defineProperty(e.prototype,"label",{set:function(t){this.$el.text(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this.$el.hasClass("disabled")},set:function(t){t?this.$el.removeClass("disabled"):this.$el.addClass("disabled")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.$el&&(this.$el.dispose(),this.$el=null),t.prototype.dispose.call(this)},e}(i.EventEmitter);e.Button=m;var w=function(t){function e(e,n,r,i,o,s){t.call(this),this.ID="empty",this.gitService=r,this.instantiationService=i,this.messageService=o,this.fileService=s,this.actionRunner=n,this.isVisible=!1,this.needsRender=!1,this.controller=e,this.toDispose=[]}return __extends(e,t),Object.defineProperty(e.prototype,"initAction",{get:function(){return this._initAction||(this._initAction=this.instantiationService.createInstance(u.InitAction)),this._initAction},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.render(),this.$el.getHTMLElement()},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this;if(!this.$el){this.$el=d(".empty-view"),d("p").appendTo(this.$el).text(e.EMPTY_MESSAGE);var r=d(".section").appendTo(this.$el);this.initButton=new m(r),this.initButton.label=n.localize(1,null),this.initButton.on("click",function(e){o.EventHelper.stop(e),t.disableUI(),t.actionRunner.run(t.initAction).done(function(){t.enableUI()})}),this.toDispose.push(this.gitService.addListener2(c.ServiceEvents.OPERATION,function(){return t.onGitOperation()}))}},e.prototype.disableUI=function(){this.urlInputBox&&this.urlInputBox.disable(),this.cloneButton&&(this.cloneButton.enabled=!1),this.initButton.enabled=!1},e.prototype.enableUI=function(){this.gitService.getRunningOperations().length>0||(this.urlInputBox&&(this.urlInputBox.enable(),this.urlInputBox.validate()),this.initButton.enabled=!0)},e.prototype.onError=function(t){this.messageService.show(l["default"].Error,t)},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return this.isVisible=t,s.Promise.as(null)},e.prototype.getSelection=function(){return v.Selection.EMPTY},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return this.refreshAction?[this.refreshAction]:[]},e.prototype.getSecondaryActions=function(){return[]},e.prototype.onGitOperation=function(){this.gitService.getRunningOperations().length>0?this.disableUI():this.enableUI()},e.prototype.dispose=function(){this.$el&&(this.$el.dispose(),this.$el=null),this.toDispose=r.disposeAll(this.toDispose),t.prototype.dispose.call(this)},e.EMPTY_MESSAGE=n.localize(0,null),e=__decorate([__param(2,g),__param(3,h.IInstantiationService),__param(4,f.IMessageService),__param(5,p.IFileService)],e)}(i.EventEmitter);e.EmptyView=w});var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__decorate=this&&this.__decorate||function(t,e,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,r);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,r){return void(r&&r(e,n))},void 0);case 4:return t.reduceRight(function(t,r){return r&&r(e,n,t)||t},r)}},__param=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}};define("vs/workbench/parts/git/browser/gitViewlet",["require","exports","vs/base/common/winjs.base","vs/base/common/lifecycle","vs/workbench/browser/viewlet","vs/workbench/parts/git/common/git","vs/workbench/parts/git/browser/gitWorkbenchContributions","vs/workbench/parts/git/browser/views/changes/changesView","vs/workbench/parts/git/browser/views/empty/emptyView","vs/workbench/parts/git/browser/views/gitless/gitlessView","vs/workbench/parts/git/browser/views/notroot/notrootView","vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView","./views/disabled/disabledView","vs/platform/instantiation/common/instantiation","vs/platform/progress/common/progress","vs/platform/selection/common/selection","vs/platform/telemetry/common/telemetry","vs/css!./media/gitViewlet"],function(t,e,n,r,i,o,s,a,c,u,l,p,h,f,v,g,d){var m=o.IGitService,w=function(t){function e(e,n,r,i){var o=this;t.call(this,s.VIEWLET_ID,e),this.progressService=n,this.instantiationService=r,this.gitService=i,this.progressRunner=null,this.views={},this.toDispose=[];var f=[this.instantiationService.createInstance(a.ChangesView,this.getActionRunner()),this.instantiationService.createInstance(c.EmptyView,this,this.getActionRunner()),this.instantiationService.createInstance(u.GitlessView),new l.NotRootView,new p.NoWorkspaceView,new h.DisabledView];f.forEach(function(t){o.views[t.ID]=t,o.toDispose.push(t)}),this.toUnbind.push(this.gitService.addBulkListener(function(){return o.onGitServiceChanges()}))}return __extends(e,t),e.prototype.setView=function(t){if(!this.$el)return n.Promise.as(null);var e=this.views[t];if(!e)return n.Promise.wrapError(new Error("Could not find view."));if(this.currentView===e)return n.Promise.as(null);var r=n.Promise.as(null);this.currentView&&(r=this.currentView.setVisible(!1));var i=e.element;this.currentView=e,this.updateTitleArea();for(var o=this.$el.getHTMLElement();o.firstChild;)o.removeChild(o.firstChild);return o.appendChild(i),e.layout(this.currentDimension),r.then(function(){return e.setVisible(!0)})},e.prototype.create=function(e){return t.prototype.create.call(this,e),this.$el=e.div().addClass("git-viewlet"),n.Promise.as(null)},e.prototype.setVisible=function(e){var r=this;return e?(this.onGitServiceChanges(),this.gitService.status().done(),t.prototype.setVisible.call(this,e).then(function(){return r.currentView?r.currentView.setVisible(e):void 0})):(this.currentView?this.currentView.setVisible(e):n.Promise.as(null)).then(function(){t.prototype.setVisible.call(r,e)})},e.prototype.focus=function(){t.prototype.focus.call(this),this.currentView&&this.currentView.focus()},e.prototype.layout=function(t){void 0===t&&(t=this.currentDimension),this.currentDimension=t,this.currentView&&this.currentView.layout(t)},e.prototype.getActions=function(){return this.currentView?this.currentView.getActions():[]},e.prototype.getSecondaryActions=function(){return this.currentView?this.currentView.getSecondaryActions():[]},e.prototype.getSelection=function(){return this.currentView?this.currentView.getSelection():g.Selection.EMPTY},e.prototype.getControl=function(){return this.currentView?this.currentView.getControl():null},e.prototype.onGitServiceChanges=function(){this.progressRunner&&this.progressRunner.done(),this.gitService.getState()===o.ServiceState.NoGit?(this.setView("gitless"),this.progressRunner=null):this.gitService.getState()===o.ServiceState.Disabled?(this.setView("disabled"),this.progressRunner=null):this.gitService.getState()===o.ServiceState.NotARepo?(this.setView("empty"),this.progressRunner=null):this.gitService.getState()===o.ServiceState.NotAWorkspace?(this.setView("noworkspace"),this.progressRunner=null):this.gitService.getState()===o.ServiceState.NotAtRepoRoot?(this.setView("notroot"),this.progressRunner=null):this.gitService.isIdle()?(this.setView("changes"),this.progressRunner=null):this.progressRunner=this.progressService.show(!0)},e.prototype.dispose=function(){this.toDispose=r.disposeAll(this.toDispose),this.views=null,t.prototype.dispose.call(this)},e=__decorate([__param(0,d.ITelemetryService),__param(1,v.IProgressService),__param(2,f.IInstantiationService),__param(3,m)],e)}(i.Viewlet);e.GitViewlet=w});