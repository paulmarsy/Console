/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
define("vs/css!vs/workbench/parts/debug/browser/media/repl",["vs/css!vs/workbench/parts/debug/browser/repl"],{}),define("vs/nls!vs/workbench/parts/debug/browser/replViewer",["vs/nls","vs/nls!vs/workbench/parts/debug/browser/repl"],function(e,t){return e.create("vs/workbench/parts/debug/browser/replViewer",t)}),define("vs/workbench/parts/debug/common/replHistory",["require","exports"],function(e,t){"use strict";var r=50,n=function(){function e(e){this.history=e,this.historyPointer=this.history.length,this.currentExpressionStoredMarkers=!1,this.historyOverwrites={}}return e.prototype.next=function(){return this.navigate(!1)},e.prototype.previous=function(){return this.navigate(!0)},e.prototype.navigate=function(e){var t=-1;return e&&this.historyPointer>0&&this.history.length>this.historyPointer-1?t=this.historyPointer-1:!e&&this.history.length>this.historyPointer+1&&(t=this.historyPointer+1),t>=0?(this.historyPointer=t,this.historyOverwrites&&this.historyOverwrites[t.toString()]?this.historyOverwrites[t.toString()]:this.history[t]):null},e.prototype.remember=function(e,t){var r;r=t?this.historyPointer+1:this.historyPointer-1,r!==this.history.length||this.currentExpressionStoredMarkers?(this.historyOverwrites||(this.historyOverwrites={}),this.historyOverwrites[r.toString()]=e):(this.history.push(e),this.currentExpressionStoredMarkers=!0)},e.prototype.evaluated=function(e){this.currentExpressionStoredMarkers&&this.history.pop(),!e||0!==this.history.length&&this.history[this.history.length-1]===e||this.history.push(e),this.historyPointer=this.history.length,this.currentExpressionStoredMarkers=!1,this.historyOverwrites=null},e.prototype.save=function(){return this.currentExpressionStoredMarkers&&this.history.pop(),this.history.length>r&&(this.history=this.history.splice(this.history.length-r,r)),this.history},e}();t.ReplHistory=n});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__decorate=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=3>i?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(3>i?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},__param=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};define("vs/workbench/parts/debug/browser/replViewer",["require","exports","vs/nls!vs/workbench/parts/debug/browser/replViewer","vs/base/common/winjs.base","vs/base/common/strings","vs/base/common/uri","vs/base/common/platform","vs/base/browser/ui/actionbar/actionbar","vs/base/browser/dom","vs/base/common/errors","vs/base/common/severity","vs/base/browser/mouseEvent","vs/workbench/parts/debug/common/debugModel","vs/workbench/parts/debug/browser/debugViewer","vs/workbench/parts/debug/electron-browser/debugActions","vs/workbench/services/editor/common/editorService","vs/platform/workspace/common/workspace"],function(e,t,r,n,o,i,s,a,p,c,u,l,h,d,v,f,y){"use strict";function m(){return s.isMacintosh?".expression.mac":".expression.win-linux"}var b=p.emmet,g=function(){function e(e){this.debugService=e}return e.prototype.getId=function(e,t){return t.getId()},e.prototype.hasChildren=function(e,t){return t instanceof h.Model||t.reference>0||t instanceof h.KeyValueOutputElement&&t.getChildren().length>0},e.prototype.getChildren=function(e,t){return t instanceof h.Model?n.TPromise.as(t.getReplElements()):t instanceof h.KeyValueOutputElement?n.TPromise.as(t.getChildren()):t instanceof h.ValueOutputElement?n.TPromise.as(null):t.getChildren(this.debugService)},e.prototype.getParent=function(e,t){return n.TPromise.as(null)},e}();t.ReplExpressionsDataSource=g;var E=function(){function e(e,t){this.editorService=e,this.contextService=t}return e.prototype.getHeight=function(e,t){return this.getHeightForString(t.value)+(t instanceof h.Expression?this.getHeightForString(t.name):0)},e.prototype.getHeightForString=function(e){if(!e||!e.length||!this.width||this.width<=0||!this.characterWidth||this.characterWidth<=0)return 18;for(var t=0,r=0;r<e.length;r++)t+=o.isFullWidthCharacter(e.charCodeAt(r))?2:1;return 18*Math.ceil(t*this.characterWidth/this.width)},e.prototype.setWidth=function(e,t){this.width=e,this.characterWidth=t},e.prototype.getTemplateId=function(t,r){return r instanceof h.Variable?e.VARIABLE_TEMPLATE_ID:r instanceof h.Expression?e.INPUT_OUTPUT_PAIR_TEMPLATE_ID:r instanceof h.ValueOutputElement?e.VALUE_OUTPUT_TEMPLATE_ID:r instanceof h.KeyValueOutputElement?e.KEY_VALUE_OUTPUT_TEMPLATE_ID:null},e.prototype.renderTemplate=function(t,r,n){if(r===e.VARIABLE_TEMPLATE_ID){var o=Object.create(null);return o.expression=p.append(n,b(m())),o.name=p.append(o.expression,b("span.name")),o.value=p.append(o.expression,b("span.value")),o}if(r===e.INPUT_OUTPUT_PAIR_TEMPLATE_ID){var o=Object.create(null);return p.addClass(n,"input-output-pair"),o.input=p.append(n,b(".input"+m())),o.output=p.append(n,b(".output"+m())),o.value=p.append(o.output,b("span.value")),o.annotation=p.append(o.output,b("span")),o}if(r===e.VALUE_OUTPUT_TEMPLATE_ID){var o=Object.create(null);p.addClass(n,"output");var i=p.append(n,b(".output"+m()));return o.container=n,o.counter=p.append(i,b("div.counter")),o.value=p.append(i,b("span.value")),o}if(r===e.KEY_VALUE_OUTPUT_TEMPLATE_ID){var o=Object.create(null);return p.addClass(n,"output"),o.container=n,o.expression=p.append(n,b(".output"+m())),o.key=p.append(o.expression,b("span.name")),o.value=p.append(o.expression,b("span.value")),o.annotation=p.append(o.expression,b("span")),o}},e.prototype.renderElement=function(t,r,n,o){n===e.VARIABLE_TEMPLATE_ID?d.renderVariable(t,r,o,!1):n===e.INPUT_OUTPUT_PAIR_TEMPLATE_ID?this.renderInputOutputPair(t,r,o):n===e.VALUE_OUTPUT_TEMPLATE_ID?this.renderOutputValue(r,o):n===e.KEY_VALUE_OUTPUT_TEMPLATE_ID&&this.renderOutputKeyValue(t,r,o)},e.prototype.renderInputOutputPair=function(e,t,n){n.input.textContent=t.name,d.renderExpressionValue(t,n.value,!1),t.reference>0&&(n.annotation.className="annotation octicon octicon-info",n.annotation.title=r.localize(0,null))},e.prototype.renderOutputValue=function(e,t){e.counter>1?(t.counter.textContent=String(e.counter),t.counter.className=e.severity===u["default"].Warning?"counter warn":e.severity===u["default"].Error?"counter error":"counter info"):(t.counter.textContent="",t.counter.className="counter"),p.clearNode(t.value);var r=this.handleANSIOutput(e.value);"string"==typeof r?t.value.textContent=r:t.value.appendChild(r),t.value.className=e.severity===u["default"].Warning?"warn":e.severity===u["default"].Error?"error":"info"},e.prototype.handleANSIOutput=function(e){for(var t,r,n="",o=0,i=e.length;i>o;o++)if(27===e.charCodeAt(o)){var s=o,a=++s<i?e.charAt(s):null;if(a&&"["===a){var p=null;if(a=++s<i?e.charAt(s):null,a&&a>="0"&&"9">=a&&(p=a,a=++s<i?e.charAt(s):null),a&&a>="0"&&"9">=a&&(p+=a,a=++s<i?e.charAt(s):null),null===p&&(p="0"),"m"===a){var c=parseInt(p,10),u=document.createElement("span");c>=30&&37>=c||c>=90&&97>=c?u.className="code"+c:1===c&&(u.className="code-bold"),t||(t=document.createElement("span")),n&&(this.insert(this.handleLinks(n),r||t),n=""),r=u,t.appendChild(u),o=s}}}else n+=e[o];if(n){var l=this.handleLinks(n);("string"!=typeof l||r)&&(t||(t=document.createElement("span")),this.insert(l,r||t))}return t||n},e.prototype.insert=function(e,t){"string"==typeof e?t.textContent=e:t.appendChild(e)},e.prototype.handleLinks=function(t){for(var n,o=this,a=0,p=e.FILE_LOCATION_PATTERNS;a<p.length;a++){var c=p[a];c.lastIndex=0;var u=c.exec(t),h=u&&i["default"].file(u[1]);if(h){n=document.createElement("span");var d=t.substr(0,u.index);if(d){var v=document.createElement("span");v.textContent=d,n.appendChild(v)}var f=document.createElement("a");f.textContent=t.substr(u.index,u[0].length),f.title=s.isMacintosh?r.localize(1,null):r.localize(2,null),n.appendChild(f),f.onclick=function(e){return o.onLinkClick(new l.StandardMouseEvent(e),h,Number(u[3]),Number(u[4]))};var y=t.substr(u.index+u[0].length);if(y){var v=document.createElement("span");v.textContent=y,n.appendChild(v)}break}}return n||t},e.prototype.onLinkClick=function(e,t,r,n){var o=window.getSelection();"Range"!==o.type&&(e.preventDefault(),this.editorService.openEditor({resource:t,options:{selection:{startLineNumber:r,startColumn:n}}},e.ctrlKey||e.metaKey).done(null,c.onUnexpectedError))},e.prototype.renderOutputKeyValue=function(e,t,r){t.key?r.key.textContent=t.key+":":r.key.textContent="",d.renderExpressionValue(t.value,r.value,!1),t.annotation?(r.annotation.className="annotation octicon octicon-info",r.annotation.title=t.annotation):(r.annotation.className="",r.annotation.title="")},e.prototype.disposeTemplate=function(e,t,r){},e.VARIABLE_TEMPLATE_ID="variable",e.INPUT_OUTPUT_PAIR_TEMPLATE_ID="inputOutputPair",e.VALUE_OUTPUT_TEMPLATE_ID="outputValue",e.KEY_VALUE_OUTPUT_TEMPLATE_ID="outputKeyValue",e.FILE_LOCATION_PATTERNS=[/((\/|[a-zA-Z]:\\)[^\(\)<>\'\"\[\]]+):(\d+):(\d+)/],e=__decorate([__param(0,f.IWorkbenchEditorService),__param(1,y.IWorkspaceContextService)],e)}();t.ReplExpressionsRenderer=E;var _=function(){function e(){}return e.prototype.getAriaLabel=function(e,t){return t instanceof h.Variable?r.localize(3,null,t.name,t.value):t instanceof h.Expression?r.localize(4,null,t.name,t.value):t instanceof h.ValueOutputElement?r.localize(5,null,t.value):t instanceof h.KeyValueOutputElement?r.localize(6,null,t.key,t.value):null},e}();t.ReplExpressionsAccessibilityProvider=_;var S=function(){function e(e){this.instantiationService=e}return e.prototype.hasActions=function(e,t){return!1},e.prototype.getActions=function(e,t){return n.TPromise.as([])},e.prototype.hasSecondaryActions=function(e,t){return!0},e.prototype.getSecondaryActions=function(e,t){var r=[];return(t instanceof h.Variable||t instanceof h.Expression)&&(r.push(this.instantiationService.createInstance(v.AddToWatchExpressionsAction,v.AddToWatchExpressionsAction.ID,v.AddToWatchExpressionsAction.LABEL,t)),r.push(new a.Separator)),r.push(this.instantiationService.createInstance(v.ClearReplAction,v.ClearReplAction.ID,v.ClearReplAction.LABEL)),n.TPromise.as(r)},e.prototype.getActionItem=function(e,t,r){return null},e}();t.ReplExpressionsActionProvider=S;var T=function(e){function t(t,r,n,o,i){void 0===i&&(i=!0),e.call(this,t,r,n,i),this.replInput=o,this.lastSelectedString=null}return __extends(t,e),t.prototype.onLeftClick=function(t,r,n,o){void 0===o&&(o="mouse");var i=n;(r.reference>0||r instanceof h.KeyValueOutputElement&&r.getChildren().length>0)&&-1===i.target.className.indexOf("input expression")&&(e.prototype.onLeftClick.call(this,t,r,n,o),t.clearFocus(),t.deselect(r));var s=window.getSelection();return"Range"===s.type&&this.lastSelectedString!==s.toString()||this.replInput.focus(),this.lastSelectedString=s.toString(),!0},t.prototype.onDown=function(t,r){if(t.getFocus())return e.prototype.onDown.call(this,t,r);var n={origin:"keyboard",originalEvent:r};return t.focusLast(n),t.reveal(t.getFocus()).done(null,c.onUnexpectedError),!0},t}(d.BaseDebugController);t.ReplExpressionsController=T});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__decorate=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=3>i?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(3>i?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},__param=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};define("vs/workbench/parts/debug/browser/repl",["require","exports","vs/nls!vs/workbench/parts/debug/browser/repl","vs/base/common/errors","vs/base/common/lifecycle","vs/base/browser/dom","vs/base/common/platform","vs/base/parts/tree/browser/treeImpl","vs/workbench/parts/debug/browser/replViewer","vs/workbench/parts/debug/common/debug","vs/workbench/parts/debug/electron-browser/debugActions","vs/workbench/parts/debug/common/replHistory","vs/workbench/browser/panel","vs/platform/telemetry/common/telemetry","vs/platform/contextview/browser/contextView","vs/platform/instantiation/common/instantiation","vs/workbench/services/workspace/common/contextService","vs/platform/storage/common/storage","vs/base/common/keyCodes","vs/css!./media/repl"],function(e,t,r,n,o,i,s,a,p,c,u,l,h,d,v,f,y,m,b){"use strict";var g=i.emmet,E={indentPixels:8,twistiePixels:20,paddingOnRow:!1,ariaLabel:r.localize(0,null)},_="debug.repl.history",S=function(e){function t(t,r,n,o,i,s,a){e.call(this,c.REPL_ID,o),this.debugService=t,this.contextMenuService=r,this.contextService=n,this.instantiationService=i,this.contextViewService=s,this.storageService=a,this.toDispose=[],this.registerListeners()}return __extends(t,e),t.prototype.registerListeners=function(){var e=this;this.toDispose.push(this.debugService.getModel().addListener2(c.ModelEvents.REPL_ELEMENTS_UPDATED,function(t){e.onReplElementsUpdated(t)}))},t.prototype.onReplElementsUpdated=function(e){var r=this;if(this.tree){if(this.refreshTimeoutHandle)return;this.refreshTimeoutHandle=setTimeout(function(){r.refreshTimeoutHandle=null;var e=r.tree.getScrollPosition();r.tree.refresh().then(function(){return 0===e||1===e?r.tree.setScrollPosition(1):void 0},n.onUnexpectedError)},t.REFRESH_DELAY)}},t.prototype.create=function(r){var n=this;e.prototype.create.call(this,r);var o=i.append(r.getHTMLElement(),g(".repl"));this.treeContainer=i.append(o,g(".repl-tree"));var c=i.append(o,g(s.isWindows?".repl-input-wrapper.windows":s.isMacintosh?".repl-input-wrapper.mac":".repl-input-wrapper.linux"));this.replInput=i.append(c,g("input.repl-input")),this.replInput.type="text",this.toDispose.push(i.addStandardDisposableListener(this.replInput,"keydown",function(e){var r=n.replInput.value.trim();if(e.equals(b.CommonKeybindings.ENTER)&&r)n.debugService.addReplExpression(r),t.HISTORY.evaluated(r),n.replInput.value="",e.preventDefault();else if(e.equals(b.CommonKeybindings.UP_ARROW)||e.equals(b.CommonKeybindings.DOWN_ARROW)){var o=e.equals(b.CommonKeybindings.UP_ARROW)?t.HISTORY.previous():t.HISTORY.next();o&&(t.HISTORY.remember(n.replInput.value,e.equals(b.CommonKeybindings.UP_ARROW)),n.replInput.value=o,e.preventDefault())}})),this.toDispose.push(i.addStandardDisposableListener(this.replInput,i.EventType.FOCUS,function(){return i.addClass(c,"synthetic-focus")})),this.toDispose.push(i.addStandardDisposableListener(this.replInput,i.EventType.BLUR,function(){return i.removeClass(c,"synthetic-focus")})),this.characterWidthSurveyor=i.append(o,g(".surveyor")),this.characterWidthSurveyor.textContent=t.HALF_WIDTH_TYPICAL;for(var u=0;10>u;u++)this.characterWidthSurveyor.textContent+=this.characterWidthSurveyor.textContent;return this.characterWidthSurveyor.style.fontSize=s.isMacintosh?"12px":"14px",this.renderer=this.instantiationService.createInstance(p.ReplExpressionsRenderer),this.tree=new a.Tree(this.treeContainer,{dataSource:new p.ReplExpressionsDataSource(this.debugService),renderer:this.renderer,accessibilityProvider:new p.ReplExpressionsAccessibilityProvider,controller:new p.ReplExpressionsController(this.debugService,this.contextMenuService,new p.ReplExpressionsActionProvider(this.instantiationService),this.replInput,!1)},E),t.HISTORY||(t.HISTORY=new l.ReplHistory(JSON.parse(this.storageService.get(_,m.StorageScope.WORKSPACE,"[]")))),this.tree.setInput(this.debugService.getModel())},t.prototype.layout=function(e){this.tree&&(this.renderer.setWidth(e.width-25,this.characterWidthSurveyor.clientWidth/this.characterWidthSurveyor.textContent.length),this.tree.layout(e.height-22),this.tree.refresh().done(void 0,n.onUnexpectedError))},t.prototype.focus=function(){this.replInput.focus()},t.prototype.reveal=function(e){return this.tree.reveal(e)},t.prototype.getActions=function(){var e=this;return this.actions||(this.actions=[this.instantiationService.createInstance(u.ClearReplAction,u.ClearReplAction.ID,u.ClearReplAction.LABEL)],this.actions.forEach(function(t){e.toDispose.push(t)})),this.actions},t.prototype.shutdown=function(){this.storageService.store(_,JSON.stringify(t.HISTORY.save()),m.StorageScope.WORKSPACE)},t.prototype.dispose=function(){this.toDispose=o.disposeAll(this.toDispose),e.prototype.dispose.call(this)},t.HALF_WIDTH_TYPICAL="n",t.REFRESH_DELAY=500,t=__decorate([__param(0,c.IDebugService),__param(1,v.IContextMenuService),__param(2,y.IWorkspaceContextService),__param(3,d.ITelemetryService),__param(4,f.IInstantiationService),__param(5,v.IContextViewService),__param(6,m.IStorageService)],t)}(h.Panel);t.Repl=S});
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/fa6d0f03813dfb9df4589c30121e9fcffa8a8ec8/vs\workbench\parts\debug\browser\repl.js.map
