function showHostVersion(){var e=Microsoft.Plugin.Host.version.major+"."+Microsoft.Plugin.Host.version.minor+"."+Microsoft.Plugin.Host.version.build+"."+Microsoft.Plugin.Host.version.revision;document.getElementById("versionInfo").innerText=e}function toggleCanCreatePopup(){return window.__canCreatePopupToggle=!window.__canCreatePopupToggle}function onToggleCanShowPopupButtonClick(){var e=document.testPlugin.toggleCanShowPopupButton,t=document.testPlugin.toggleCanShowPopupCMButton;Microsoft.Plugin.ContextMenu.dismissAll(),toggleCanCreatePopup()?(e.innerHTML="Showing tooltips in popup",t.innerHTML="Showing context menus in popup",relativeIconState=!0):(e.innerHTML="Showing tooltips in inline div",t.innerHTML="Showing context menus in inline div",relativeIconState=!1)}function onToggleDefaultTooltipContentToHTMLButtonClick(){Microsoft.Plugin.Tooltip.defaultTooltipContentToHTML=!Microsoft.Plugin.Tooltip.defaultTooltipContentToHTML;var e=document.testPlugin.toggleDefaultTooltipContentToHTMLButton;e.innerHTML=Microsoft.Plugin.Tooltip.defaultTooltipContentToHTML?"Allowing HTML in Tooltips":"Disallowing HTML in Tooltips"}function pluginErrorHandler(e){var t=document.getElementById("pluginMessages");return t&&(t.innerHTML+="</br>Error: "+e),!0}function onFileListTestButtonClick(){var e=parseInt(document.testPlugin.fileTest0aTextBox.value||"0"),t=parseInt(document.testPlugin.fileTest0bTextBox.value||"0");return Microsoft.Plugin.Storage.getFileList(document.testPlugin.fileListTextBox.value,Microsoft.Plugin.Storage.FilePersistence.temporary,e,t).done(function(e){for(var t in e)document.testPlugin.fileListTextArea.value+=e[t]+"\r\n"}),!1}function onFileTest1ButtonClick(){return""==document.testPlugin.fileTest1ToWrite.value?(document.testPlugin.fileTest1Result.value="Please enter data to write.",!1):(Microsoft.Plugin.Storage.createFile(document.testPlugin.fileTest1TextBox.value).done(function(e){e.write(document.testPlugin.fileTest1ToWrite.value).done(function(){e.close().done(function(){document.testPlugin.fileTest1Result.value="File write and close was successful."})})},function(e){document.testPlugin.fileTest1Result.value="Could not open file.\r\n"+e.message}),!1)}function onFileTest2ButtonClick(){var e=document.testPlugin.fileTest2TextBox.value;return""===e||null===e||"undefined"==typeof e?(document.testPlugin.fileTest2Result.value="File path cannot be empty.\r\n",!1):(Microsoft.Plugin.Storage.openFile(document.testPlugin.fileTest2TextBox.value).done(function(e){e.read().done(function(t){e.close().done(function(){document.testPlugin.fileTest2Result.value=t+"\r\nFile read and close was successful."})})},function(e){document.testPlugin.fileTest2Result.value="Could not open file.\r\n"+e.message}),!1)}function onFileTest3aButtonClick(){var fileName=document.testPlugin.fileTest3TextBox.value;if(""===fileName||null===fileName||"undefined"==typeof fileName)return document.testPlugin.fileTest3Result.value="File path cannot be empty.\r\n",!1;var shareSelect=document.getElementById("fileTest3ShareList"),share=shareSelect.options[shareSelect.selectedIndex].value,accessSelect=document.getElementById("fileTest3AccessList"),access=accessSelect.options[accessSelect.selectedIndex].value,fileOptions={access:eval(access),encoding:"UTF-8",mode:Microsoft.Plugin.Storage.FileMode.open,persistence:Microsoft.Plugin.Storage.FilePersistence.temporary,share:eval(share),type:Microsoft.Plugin.Storage.FileType.text};return Microsoft.Plugin.Storage.openFile(document.testPlugin.fileTest3TextBox.value,fileOptions).done(function(e){test3File=e,test3OpenFiles[test3FileIndex++]=test3File,document.testPlugin.fileTest3Result.value="\r\nFile open was successful."},function(e){document.testPlugin.fileTest3Result.value="Could not open file.\r\n"+e.message}),!1}function onFileTest3bButtonClick(){if(null==test3File)return document.testPlugin.fileTest3Result.value="\r\nThere is no open file to seek.",!1;var offset=document.testPlugin.fileTest3OffsetTextBox.value;if(""==offset)return document.testPlugin.fileTest3Result.value="\r\nPlease enter an offset and try to Seek again.",!1;var select=document.getElementById("fileTest3SelectList"),origin=eval(select.options[select.selectedIndex].value);return test3File.seek(offset,origin).done(function(e){document.testPlugin.fileTest3Result.value="\r\nFile seek was successful. Current position: "+e}),!1}function onFileTest3cButtonClick(){return null==test3File?(document.testPlugin.fileTest3Result.value="\r\nThere is no open file to read.",!1):(test3File.read().done(function(e){document.testPlugin.fileTest3Result.value+="\r\n"+e}),!1)}function onFileTest3dButtonClick(){if(!test3FileIndex)return document.testPlugin.fileTest3Result.value="\r\nThere is no open file to close.",!1;for(var e=0;test3FileIndex>e;e++)test3OpenFiles[e].close().done(function(){document.testPlugin.fileTest3Result.value="\r\nFile close was successful."});return test3OpenFiles=[],test3FileIndex=0,test3File=null,!1}function onFileTest4ButtonClick(){var e={access:Microsoft.Plugin.Storage.FileAccess.readWrite,encoding:"UTF-8",mode:Microsoft.Plugin.Storage.FileMode.openOrCreate,persistence:Microsoft.Plugin.Storage.FilePersistence.temporary,type:Microsoft.Plugin.Storage.FileType.binary},t=new Array;return t[0]=255,t[1]=254,t[2]=253,t[3]=252,t[4]=251,t[5]=250,Microsoft.Plugin.Storage.openFile("binaryTest.bin",e).done(function(e){e.write(t).done(function(){e.seek(0,0).done(function(t){e.read().done(function(t){e.close().done(function(){for(var e in t)document.testPlugin.fileTest4Result.value+=t[e]+"  ";document.testPlugin.fileTest4Result.value+="\r\nFile read and close was successful."})})})})}),!1}function onFileTest5ButtonClick(){var e={name:document.testPlugin.fileTest5FileNameTextBox.value,extensions:convertToExtensionsArray(document.testPlugin.fileTest5ExtensionsTextBox.value),extensionsIndex:document.testPlugin.fileTest5ExtensionsIndexTextBox.value,initialDirectory:document.testPlugin.fileTest5InitialDirectoryTextBox.value,title:document.testPlugin.fileTest5TitleTextBox.value};return Microsoft.Plugin.Storage.openFileDialog(e).done(function(e){e&&e.read().done(function(t){e.close().done(function(){document.testPlugin.fileTest5Result.value=t})})}),!1}function onFileTest6ButtonClick(){var e={name:document.testPlugin.fileTest5FileNameTextBox.value,extensions:convertToExtensionsArray(document.testPlugin.fileTest5ExtensionsTextBox.value),extensionsIndex:document.testPlugin.fileTest5ExtensionsIndexTextBox.value,initialDirectory:document.testPlugin.fileTest5InitialDirectoryTextBox.value,title:document.testPlugin.fileTest5TitleTextBox.value},t={access:Microsoft.Plugin.Storage.FileAccess.write,encoding:"UTF-16",mode:Microsoft.Plugin.Storage.FileMode.openOrCreate,persistence:Microsoft.Plugin.Storage.FilePersistence.permanent,type:Microsoft.Plugin.Storage.FileType.text};return Microsoft.Plugin.Storage.saveFileDialog(e,t).done(function(e){e&&e.write("hello").done(function(){e.close().done(function(){})})}),!1}function convertToExtensionsArray(e){return e.split("||")}function pause(e){for(var t=new Date;new Date-t<e;);}function onBlockButtonClick(){return pause(5e3),!1}function onHangButtonClick(){return pause(1e4),!1}function onOpenDocumentButton(){return Microsoft.Plugin.Host.showDocument(document.testPlugin.documentUriTextBox.value,document.testPlugin.documentLineTextBox.value,document.testPlugin.documentColTextBox.value),!1}function onClearButtonClick(){return document.testPlugin.textbox.value="",!1}function throwError(){undeclared_function()}function onTerminateClick(){Microsoft.Plugin.Diagnostics.terminate()}function onSetValueClick(){var e=document.testPlugin.collectionTextbox.value,t={};try{t=JSON.parse(document.testPlugin.valuesTextbox.value),Microsoft.Plugin.Settings.set(e,t),alert("Value successfully saved.")}catch(n){alert('Values: "'+n+'"')}}function onGetValueClick(){var e=document.testPlugin.collectionTextbox.value,t=document.testPlugin.keyTextbox.value,n=[];0!=t.length&&(-1!=t.indexOf(",")?n=t.split(","):n.push(t));for(var o=[],i=0;i<n.length;i++)o.push(n[i].trim());var u={};try{u=JSON.parse(document.testPlugin.defaultValuesTextbox.value)}catch(s){}Microsoft.Plugin.Settings.get(e,o).done(function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t+='"'+n+'" : '+e[n]+"\n");alert(t)},function(e){alert(e.message)})}function getResource(e){document.getElementById("ResourcesTest").innerHTML=e+"  => "+Microsoft.Plugin.Resources.getString("apple")}function getDynamicResource(e){Microsoft.Plugin.Resources.loadResourceFile({alias:"dynamic",path:"Resources\\DynamicResources",type:Microsoft.Plugin.Resources.ResourceType.resjson}).then(function(){document.getElementById("ResourcesTest").innerHTML=e+"  => "+Microsoft.Plugin.Resources.getString("/dynamic/foo")})}function onResourcesTestButtonClick(){return getResource("onButtonClick"),!1}function onValidateDynamicResourceDoesNotExistButtonClick(){var e=!1;try{Microsoft.Plugin.Resources.getString("/dynamic/foo")}catch(t){e=!0}var n=e?'Got exception saying "/dynamic/foo" does not exist':'"/dynamic/foo" already exists!';document.getElementById("ResourcesTest").innerHTML="test result => "+n}function onDynamicResourcesTestButtonClick(){return getDynamicResource("onButtonClick"),hasLoadedDynamicResource=!0,document.getElementById("validateDoesNotExistButton").disabled=!0,document.getElementById("dynamicResourceButton").disabled=!0,!1}function onXHRWrappedInPromiseButton(){var e=document.getElementById("xhrWrappedInPromiseDiv");e.innerHTML="Sending Request";var t=document.testPlugin.xhrURLTextbox.value,n=document.getElementById("xhrWrappedInPromiseButton");n.disabled=!0;try{Microsoft.Plugin.Utilities.xhr({url:t}).then(function(t){e.innerHTML="Response Received: "+t.responseText,n.disabled=!1},function(t){e.innerHTML="Error Received: "+t.status,n.disabled=!1})}catch(o){e.innerHTML="Error: "+o,n.disabled=!1}}function onLogMessageButton(){return Microsoft.Plugin.log(document.testPlugin.logTextbox.value),!1}function onTestPerfAnalyticsClick(){expectedId=101,Microsoft.Plugin.PerfAnalytics.raiseEvent(expectedId)}function onTestPerfAnalyticsWithKeyClick(){expectedId=101,expectedMetadata=[413],Microsoft.Plugin.PerfAnalytics.raiseEventWithKey(expectedId,expectedMetadata[0])}function onTestPerfAnalyticsWithMetadataClick(){expectedId=101,expectedMetadata=["Test1",493],Microsoft.Plugin.PerfAnalytics.raiseEvent(expectedId,expectedMetadata)}function onTestPerfAnalyticsWithBadId(){var e=perfAnalyticsHost.raiseEvent;perfAnalyticsHost.raiseEvent=originalPerfAnalyticsRaiseEvent;try{Microsoft.Plugin.PerfAnalytics.raiseEvent(0)}catch(t){return document.getElementById("perfTrackResultsDiv").innerHTML="Caught exception: "+t.toString(),void(perfAnalyticsHost.raiseEvent=e)}document.getElementById("perfTrackResultsDiv").innerHTML="No exception seen even when calling raiseEvent with a bad id!!",perfAnalyticsHost.raiseEvent=e}function onActivityLogTestButton(){return Microsoft.Plugin.VS.ActivityLog.info("Info test: %s",document.testPlugin.logTextbox.value),Microsoft.Plugin.VS.ActivityLog.warn("Warn test: %s",document.testPlugin.logTextbox.value),Microsoft.Plugin.VS.ActivityLog.error("Error test: %s",document.testPlugin.logTextbox.value),!1}function isDisabled(){return disableState}function isChecked(){return checkedState}function isHidden(){return!1}function relativeIconIsHidden(){return relativeIconState}function contextCallbackHello(e,t,n){document.getElementById("contextMenuTestBox").style.backgroundColor="green"}function contextCallbackGoodbye(e,t,n){document.getElementById("contextMenuTestBox").style.backgroundColor="blue"}function contextCallbackParent(e,t,n){document.getElementById("contextMenuTestBox").style.backgroundColor="orange"}function contextCallbackToggleCheckbox(e,t,n){checkedState=t.checked()}function checkContextMenu(){var e=document.getElementById("contextMenuUpDiv");e.innerHTML="Is context menu up: "+Microsoft.Plugin.ContextMenu.isShowing}function showContextMenu(e){htmlContextMenu2.show(e.clientX,e.clientY),e.stopPropagation(),e.preventDefault()}function dismissContextMenu(e){Microsoft.Plugin.ContextMenu.dismissAll(),e.stopPropagation(),e.preventDefault()}function toggleDisable(e){disableState=!disableState}function attachContextMenu(e){htmlContextMenu3&&null!==htmlContextMenu3.id||(htmlContextMenu3=Microsoft.Plugin.ContextMenu.create(attachDetachTestMenu,null,null,null,contextCallbackParent)),htmlContextMenu3.attach(document.getElementById("contextMenuTestBox2"))}function detachContextMenu(e){htmlContextMenu3&&null!==htmlContextMenu3.id&&htmlContextMenu3.detach(document.getElementById("contextMenuTestBox2"))}function disposeContextMenu(e){htmlContextMenu3&&null!==htmlContextMenu3.id&&htmlContextMenu3.dispose()}function loadCSS(){Microsoft.Plugin.Theme.processCSSFileForThemeing("Styles\\dynamic.css").then(function(e){var t=document.createElement("style");t.type="text/css",t.innerHTML=e;var n=document.getElementById("themingTargetDiv");n.insertBefore(t,n.firstChild)})}function addInputAndTextArea(){var e=document.createElement("input"),t=document.createElement("textarea"),n=document.createElement("div");n.innerHTML="This text should not be selectable";var o=document.createElement("br"),i=document.getElementById("dynamicSelectTest");i.appendChild(e),i.appendChild(t),i.appendChild(n),i.appendChild(o)}function updateFocusMessage(e,t){var n=document.getElementById(e);n.setAttribute("style",t?"":"display: none")}function updateFocusState(e){updateFocusMessage("focusStatusFocused",e),updateFocusMessage("focusStatusUnfocused",!e)}function reportSimpleError(){var e=Microsoft.Plugin.Diagnostics.reportError("Test Error Message","ScriptedHostTestPlugin","0","<Additional Information provided here>","0");document.testPlugin.reportErrorResult.innerText="0x"+e.toString(16)}function largeInfoRepro(){var e="Value cannot be null.\r\nParameter name: key",t="0",n="Error description:  "+e;n+="\r\nError stack:     at System.Collections.Generic.Dictionary`2.FindEntry(TKey key)",n+="\r\n   at System.Collections.Generic.Dictionary`2.get_Item(TKey key)",n+="\r\n   at Microsoft.VisualStudio.WebClient.Diagnostics.PerformanceToolHost.Package.Extensions.Persistence.Storage.OpenFile(String storageId, String relativePath, FileAccess access) in d:\\EnlistsVS\\Q11W_PerfTools\\src\\bptoob\\PerfTools\\PerformanceToolHost\\Package\\Extensions\\Persistence\\Storage.cs:line 82",n+="\r\n   at Microsoft.VisualStudio.ScriptedHost.Messaging.JsonPortMarshaler.<>c__DisplayClass16`4.<RegisterMethod>b__15(Object[] parameters)",n+="\r\n   at Microsoft.VisualStudio.ScriptedHost.Messaging.JsonPortMarshaler.MessageReceived(String messageText)",n+="\r\n   at Microsoft.VisualStudio.ScriptedHost.Messaging.PortMarshaler.OnMessage(Object sender, MessageEventArgs e)",n+="\r\nSource:  SnapshotFailed";var o=Microsoft.Plugin.Diagnostics.reportError(e,"ScriptedHostTestPlugin",t,n,"0");document.testPlugin.reportErrorResult.innerText="0x"+o.toString(16)}function largeMessageRepro(){var e=Microsoft.Plugin.Diagnostics.reportError(new Array(5e3).join("a"));document.testPlugin.reportErrorResult.innerText="0x"+e.toString(16)}function reportErrorObject(){try{var e=new ReferenceError("test reportError with error object");throw e.number=42,e}catch(t){var n=Microsoft.Plugin.Diagnostics.reportError(t);document.testPlugin.reportErrorResult.innerText="0x"+n.toString(16)}}function reportErrorExtraParams(){var e=window.__hostExternalObject.reportError("Test Error Message","ScriptedHostTestPlugin","0","<Additional Information provided here>",42,!0,"hello",new Error("error object"));document.testPlugin.reportErrorResult.innerText="0x"+e.toString(16)}function reportUnicodeError(){var e=Microsoft.Plugin.Diagnostics.reportError("才能ソЫⅨ蒤郳र्क्ड्राüışğİliيونيكودöÄüß§才能ソЫⅨ蒤郳र्क्ड्राüışğİliيونيكودöÄüß§Abcd123","","","啊齄丂狛狜隣郎隣兀﨩ˊ▇█〞〡￤℡㈱‐ー﹡﹢﹫、〓ⅰⅹ⒈€㈠㈩ⅠⅫ！￣ぁんァヶΑ︴АЯаяāɡㄅㄩ─╋ ︵﹄︻︱︳︴ⅰⅹɑɡ〇〾⿻⺁䜣€","");document.testPlugin.reportErrorResult.innerText="0x"+e.toString(16)}window.__canCreatePopupToggle=!0,Microsoft.Plugin.addEventListener("pluginready",function(){showHostVersion()});var tooltipHost=loadModule("plugin.host.tooltip");tooltipHost.canCreatePopup=function(){return window.__canCreatePopupToggle},Microsoft.Plugin.ContextMenu.canCreatePopup=function(){return window.__canCreatePopupToggle},"undefined"!=typeof debug&&(window.onerror=pluginErrorHandler),Microsoft.Plugin.addEventListener("close",function(){Microsoft.Plugin.log("TestPlugin closing ...")});var test3File=null,test3OpenFiles=[],test3FileIndex=0,perfAnalyticsHost=loadModule("plugin.host.perfanalytics"),originalPerfAnalyticsRaiseEvent=perfAnalyticsHost.raiseEvent,expectedId=0,expectedMetadata=[];perfAnalyticsHost.raiseEvent=function(e,t){var n="raiseEvent given:<br/>id - "+e;if(n+=expectedId===e?" - Passed<br/>":" - Failed (expected "+expectedId+")<br/>",t)for(var o=0;o<t.length;o++)n+="Metadata "+o+" - "+t[o],n+=expectedMetadata[o]===t[o]?" Passed<br/>":" Failed (expected "+expectedMetadata[o]+")<br/>";document.getElementById("perfTrackResultsDiv").innerHTML=n};var disableState=!1,checkedState=!1,relativeIconState=!0,submenuItems=new Array;submenuItems[0]={id:"",callback:null,label:"Sub1 (Non VS themed: data uri)",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAxklEQVR4XpWQIQ7CQBBFZ4ZAyCgMBoXF9ziI1nAJBIpL1LSCg/QAvQEKU4NBNYGGDAwpDWJnlv7kJ5NNdt/bAStt26bvSt8UQhERAjuH+XkDWp2DFEQ06fcmF6nhU50tC7Lo0+txAOlsWVCIPrmd1thdBorOehayII+Oida3oAg9akEheiCmBfn0uAX59LgF/tCLWbODf/JY5fBcbDNmLsmjY6L1Lcj/e3wX5P1daq2/C32g6pZ7GJv+TvVdYgEAKYxLyczZC1Lsjp8RIXSqAAAAAElFTkSuQmCC",iconDisabled:"vs-image-menu-icon1-disabled",accessKey:"Ctrl+X",disabled:isDisabled,hidden:isHidden,checked:isChecked,cssClass:"custom1",submenu:null},submenuItems[1]={id:"",callback:null,label:null,type:Microsoft.Plugin.ContextMenu.MenuItemType.separator,iconEnabled:null,iconDisabled:null,accessKey:null,disabled:isDisabled,checked:isChecked,cssClass:null,submenu:null},submenuItems[2]={id:"",callback:contextCallbackToggleCheckbox,label:"Sub2",type:Microsoft.Plugin.ContextMenu.MenuItemType.checkbox,iconEnabled:"vs-image-menu-icon2-enabled",iconDisabled:"vs-image-menu-icon2-disabled",accessKey:"Ctrl+C",hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:"custom2",submenu:null},submenuItems[3]={id:"",callback:null,label:null,type:Microsoft.Plugin.ContextMenu.MenuItemType.separator,iconEnabled:null,iconDisabled:null,accessKey:null,hidden:relativeIconIsHidden,disabled:isDisabled,checked:isChecked,cssClass:null,submenu:null},submenuItems[4]={id:"",callback:contextCallbackGoodbye,label:"Organize Usings (Non VS themed: relative image path -- for inline ONLY -- popups should use VS themed icons)",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:"Images/icon2.png",iconDisabled:"vs-image-menu-icon2-disabled",accessKey:null,hidden:relativeIconIsHidden,disabled:isDisabled,checked:isChecked,cssClass:"custom2",submenu:null};var menuItems=new Array;menuItems[0]={id:"menuItem0",callback:contextCallbackHello,label:"Refactor",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:"vs-image-menu-icon1-enabled",iconDisabled:"vs-image-menu-icon1-disabled",accessKey:"Ctrl+C",hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:"custom1",submenu:null},menuItems[1]={id:"menuItem1",callback:null,label:null,type:Microsoft.Plugin.ContextMenu.MenuItemType.separator,iconEnabled:null,iconDisabled:null,accessKey:null,hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:null,submenu:null},menuItems[2]={id:"menuItem2",callback:contextCallbackGoodbye,label:"Organize Usings",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:"vs-image-menu-icon2-enabled",iconDisabled:"vs-image-menu-icon2-disabled",accessKey:null,hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:"custom2",submenu:submenuItems},menuItems[3]={id:"menuItem3",callback:null,label:null,type:Microsoft.Plugin.ContextMenu.MenuItemType.separator,iconEnabled:null,iconDisabled:null,accessKey:null,hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:null,submenu:null},menuItems[4]={id:"menuItem4",callback:null,label:"Generate Sequence Diagram...",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:"vs-image-menu-icon3-enabled",iconDisabled:"vs-image-menu-icon3-disabled",accessKey:null,hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:"custom3",submenu:null},menuItems[5]={id:"menuItem5",callback:null,label:null,type:Microsoft.Plugin.ContextMenu.MenuItemType.separator,iconEnabled:null,iconDisabled:null,accessKey:null,hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:null,submenu:null},menuItems[6]={id:"menuItem6",callback:null,label:"Run Tests",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:"vs-image-menu-icon1-enabled",iconDisabled:"vs-image-menu-icon1-disabled",accessKey:"",hidden:isHidden,disabled:isDisabled,checked:isChecked,cssClass:"custom4",submenu:null};var menuItemsSimple=new Array;menuItemsSimple[0]={id:"simpleMenuItem0",callback:contextCallbackHello,label:"Refactor",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,disabled:isDisabled},menuItemsSimple[1]={type:Microsoft.Plugin.ContextMenu.MenuItemType.separator},menuItemsSimple[2]={id:"simpleMenuItem01",callback:contextCallbackGoodbye,label:"Organize Usings",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,disabled:isDisabled};var htmlContextMenu,htmlContextMenu2;Microsoft.Plugin.addEventListener("pluginready",function(){document.getElementById("pluginReadyLabel").style.display="none",getResource("onPluginReady"),htmlContextMenu=Microsoft.Plugin.ContextMenu.create(menuItems,null,null,null,contextCallbackParent),htmlContextMenu.attach(document.getElementById("contextMenuTestContainer")),htmlContextMenu2=Microsoft.Plugin.ContextMenu.create(menuItemsSimple,null,null,null,contextCallbackParent),htmlContextMenu2.attach(document.getElementById("contextMenuTestContainer2"))}),setInterval(function(){checkContextMenu()},500);var attachDetachTestMenu=new Array;attachDetachTestMenu[0]={id:"attachDetachTestMenuItem0",callback:contextCallbackHello,label:"Item one",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:null,iconDisabled:null,accessKey:null,cssClass:"custom1",submenu:null},attachDetachTestMenu[1]={id:"attachDetachTestMenuItem0",callback:contextCallbackGoodbye,label:"Item Two",type:Microsoft.Plugin.ContextMenu.MenuItemType.command,iconEnabled:null,iconDisabled:null,accessKey:null,cssClass:"custom2",submenu:null};var htmlContextMenu3,portMarshalTestObject=new function(){function clearStatus(){document.testPlugin.roundtripJSONBefore.innerText="",document.testPlugin.roundtripJSONAfter.innerText="",document.testPlugin.roundtripStatus.innerText=""}function readRoundTripValue(that){if(clearStatus(),!that.portMarshaler)return!1;try{return eval("that.portValue = "+document.testPlugin.roundtripEval.innerHTML),document.testPlugin.roundtripJSONBefore.innerText=JSON.stringify(that.portValue),!0}catch(error){return document.testPlugin.roundtripJSONBefore.innerText=error.message,document.testPlugin.roundtripStatus.innerText="Error before roundTrip",!1}}function handleRoundtrip(e){try{document.testPlugin.roundtripJSONAfter.innerText=JSON.stringify(e),document.testPlugin.roundtripJSONAfter.innerText===document.testPlugin.roundtripJSONBefore.innerText?document.testPlugin.roundtripStatus.innerText="Success":document.testPlugin.roundtripStatus.innerText='Warning - values before and after round trip are different! (this could be due to casting 3.5->"3.5" or conversion undefined->null)'}catch(t){document.testPlugin.roundtripJSONAfter.innerText=t.message,document.testPlugin.roundtripStatus.innerText="Error after roundTrip"}}function handleErrorRoundtrip(e){document.testPlugin.roundtripJSONAfter.innerText=e.message,document.testPlugin.roundtripStatus.innerText="Error in promise from roundTrip"}this.portMarshaler=null,this.portValue=null,this.onGenerateObject=function(){clearStatus(),document.testPlugin.roundtripEval.innerText="{ string: 'foobar', numbers: [-1, 0, 2, NaN, Infinity], empty: [null, undefined, '', {}, [], function () { }], dictionary: { key1: 'value1', key2: 'value2' }, other: [/foo/g, Date.now, new Error(), true, Math] }"},this.onGenerateInt=function(){clearStatus(),document.testPlugin.roundtripEval.innerText="-123"},this.onGenerateDouble=function(){clearStatus(),document.testPlugin.roundtripEval.innerText="1.23e-45"},this.onGenerateString=function(){clearStatus(),document.testPlugin.roundtripEval.innerText='"This sentance is false.  This sentance is true."'},this.onGenerateDate=function(){clearStatus(),document.testPlugin.roundtripEval.innerText=JSON.stringify(new Date)},this.onGenerateDictionary=function(){clearStatus(),document.testPlugin.roundtripEval.innerText="{ key1: 'value1', key2: 'value2' }"},this.onRoundtripObjectButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripObject(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onRoundtripIntButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripInt(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onRoundtripDoubleButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripDouble(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onRoundtripStringButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripString(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onRoundtripDateButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripDate(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onRoundtripDictionaryButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripDictionary(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onRoundtripEventButton=function(){readRoundTripValue(this)&&this.portMarshaler.raiseTestEvent(this.portValue).done(function(){},handleErrorRoundtrip)},this.onRoundtripEventPostButton=function(){if(readRoundTripValue(this)){var e=this.portMarshaler.postTestEvent(this.portValue);e&&(document.testPlugin.roundtripJSONBefore.innerText=document.testPlugin.roundtripStatus.innerText="Failure - Methods called with _post should not return a value")}},this.onRoundtripObjectAsyncButton=function(){readRoundTripValue(this)&&this.portMarshaler.roundtripObjectAsync(this.portValue).done(handleRoundtrip,handleErrorRoundtrip)},this.onPortExceptionButton=function(){clearStatus(),document.testPlugin.roundtripEval.innerText="",this.portMarshaler&&this.portMarshaler.causeException().done(function(){document.testPlugin.roundtripStatus.innerText="Failure - Exception not caused"},function(e){e.message.indexOf("TestException")>=0?document.testPlugin.roundtripStatus.innerText="Success":document.testPlugin.roundtripStatus.innerText="Warning - Error text message did not contain 'TestException': "+e.message})},this.onPortExceptionAsyncButton=function(){clearStatus(),document.testPlugin.roundtripEval.innerText="",this.portMarshaler&&this.portMarshaler.causeExceptionAsync().done(function(){document.testPlugin.roundtripStatus.innerText="Failure - Exception not caused"},function(e){JSON.stringify(e).indexOf("error in async method")>=0?document.testPlugin.roundtripStatus.innerText="Success":document.testPlugin.roundtripStatus.innerText="Warning - Error text message did not contain 'error in async method': "+e.message})},this.testRaiseEventCallback=function(e){e?handleRoundtrip(e.Value):document.testPlugin.roundtripStatus.innerText="No value from event"}};TestObject.addEventListener("gotfocus",function(){updateFocusState(!0)}),TestObject.addEventListener("lostfocus",function(){updateFocusState(!1)}),TestObject.addEventListener("testevent",function(e){portMarshalTestObject.testRaiseEventCallback(e)}),portMarshalTestObject.portMarshaler=TestObject,function(){"use strict";function e(e){g=e.screenX,f=e.screenY}function t(){return Microsoft.Plugin.VS.Commands.setStates({command:l,enabled:document.testPlugin.commandIsEnabled.checked,visible:document.testPlugin.commandIsVisible.checked},{command:r,enabled:document.testPlugin.copyCommandIsEnabled.checked,visible:!0}),!1}function n(){var e=JSON.parse(document.testPlugin.tooltipAttrValue.value);return e.content||e.resource||(e.content=document.testPlugin.textarea.innerText),Microsoft.Plugin.Tooltip.show(e),!1}function o(){var e=JSON.parse('{"delay":600, "duration":4000}');return e.content='<img id="vsImageTooltip" alt="Console Icons Enabled" src="images/console-icons.png" />',Microsoft.Plugin.Tooltip.show(e),!1}function i(){var e=JSON.parse('{"delay":600, "duration":4000}');return e.content='<img id="vsAnimatedImageTooltip" src="images/console-icons.png" />',Microsoft.Plugin.Tooltip.show(e),!1}function u(){return Microsoft.Plugin.Tooltip.dismiss(),!1}function s(){var e=document.getElementById("spanWithTooltip"),t=document.testPlugin.tooltipAttrValue.value;if(""===t)return e.removeAttribute("data-plugin-vs-tooltip"),!1;if(t.length>0&&"{"===t[0]){var n=JSON.parse(document.testPlugin.tooltipAttrValue.value);n.content||n.resource||(n.content=document.testPlugin.textarea.innerText),t=JSON.stringify(n)}return e.setAttribute("data-plugin-vs-tooltip",t),!1}if(Microsoft.Plugin.VS){window.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("vsSpecificTests");e.setAttribute("style","display: block")});var l,r,c,a,d,m,g,f;Microsoft.Plugin.addEventListener("pluginready",function(){function e(e){Microsoft.Plugin.VS.Keyboard.setZoomState(n.checked)}function t(e){Microsoft.Plugin.VS.Keyboard.setClipboardState(o.checked)}var n=document.getElementById("zoomingState");n&&n.addEventListener("click",e);var o=document.getElementById("clipboardState");o&&o.addEventListener("click",t),l=Microsoft.Plugin.VS.Commands.bindCommand({name:"testcommand",onexecute:function(){var e=parseInt(document.testPlugin.commandCountTextbox.value,10)+1;document.testPlugin.commandCountTextbox.value=e,Microsoft.Plugin.log("You have executed the test plugin command")},enabled:!0}),r=Microsoft.Plugin.VS.Commands.bindCommand({name:"copy",onexecute:function(){var e=parseInt(document.testPlugin.copyCommandCountTextbox.value,10)+1;document.testPlugin.copyCommandCountTextbox.value=e,Microsoft.Plugin.log("You have executed the copy command")},enabled:!0}),c=Microsoft.Plugin.VS.Commands.bindCommand({name:"contextmenucommand1",onexecute:function(){Microsoft.Plugin.log("You have executed the contextmenucommand1 command")},enabled:!0}),a=Microsoft.Plugin.VS.Commands.bindCommand({name:"contextmenucommand2",onexecute:function(){Microsoft.Plugin.log("You have executed the contextmenucommand2 command")},enabled:!0}),d=Microsoft.Plugin.VS.Commands.bindCommand({name:"contextmenucommand3",onexecute:function(){Microsoft.Plugin.log("You have executed the contextmenucommand3 command")},enabled:!0}),m=Microsoft.Plugin.VS.Commands.bindContextMenu("testcontextmenu")}),window.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("spanWithHTMLTooltip");e.onmouseover=function(){var e=JSON.parse('{"delay":0}');e.content='<p style="margin: 0px;background-color: green;"><b>Awesome HTML content!!</b></p>',Microsoft.Plugin.Tooltip.show(e)},e.onmouseout=function(){Microsoft.Plugin.Tooltip.dismiss()}}),window.addEventListener("DOMContentLoaded",function(){function l(e,t){var n=Microsoft.Plugin.VS.Utilities.createExternalObject(e,"{77DB59AC-D364-4689-BF1F-DD46845F4FE2}");if(!n)throw new Error("Failed to load testExtension.");Microsoft.Plugin.log("Successfully loaded testExtension."),document.testPlugin.loadTestExtensionButton.disabled=!1,document.testPlugin.loadExtensionWithBasePathToken.disabled=!1,t.disabled=!0,document.testPlugin.callTestHelloButton.disabled=!1,document.testPlugin.callTestHelloButton.onclick=function(e){Microsoft.Plugin.log("extension.Hello() returned: %s",n.Hello())},document.testPlugin.callTestGetSiteButton.disabled=!1,
document.testPlugin.callTestGetSiteButton.onclick=function(e){var t=n.GetSite();if(!t)throw new Error("extension.GetSite() failed.");Microsoft.Plugin.log("Name: %s",t.Name),Microsoft.Plugin.log("LocationURL: %s",t.LocationURL),Microsoft.Plugin.log("Dimensions: %dx%d",t.Width,t.Height)},document.testPlugin.callTestNoSuchMethodButton.disabled=!1,document.testPlugin.callTestNoSuchMethodButton.onclick=function(e){try{n.ThereIsNoSuchMethod()}catch(t){if(t instanceof TypeError)return void Microsoft.Plugin.log("extension.ThereIsNoSuchMethod() threw TypeError (expected): %s",t.message);throw t}throw new Error("extension.ThereIsNoSuchMethod() did not throw a TypeError.")}}document.testPlugin.contextMenuAreaTextbox.oncontextmenu=function(){return Microsoft.Plugin.VS.Commands.setStates({command:c,enabled:!0},{command:a,visible:!0},{command:d,enabled:!0}),m.show(g,f).done(function(){},function(e){throw Microsoft.Plugin.Utilities.marshalHostError(e)}),!1},document.testPlugin.contextMenuAreaTextbox2.oncontextmenu=function(){return Microsoft.Plugin.VS.Commands.setStates({command:c,enabled:!1},{command:a,visible:!1},{command:d,enabled:!1}),m.show(g,f).done(function(){},function(e){throw Microsoft.Plugin.Utilities.marshalHostError(e)}),!1},document.testPlugin.contextMenuAreaTextbox3.oncontextmenu=function(){return m.show(2147483648,2147483648).done(function(){},function(e){pluginErrorHandler("An error was encountered with showing a context menu: "+e.message)}),!1},document.testPlugin.commandStateButton.onclick=function(){return t()},document.testPlugin.contextMenuAreaTextbox.onmousedown=function(t){return e(t)},document.testPlugin.contextMenuAreaTextbox2.onmousedown=function(t){return e(t)},document.testPlugin.updateToolTipButton.onclick=function(e){return s()},document.testPlugin.showToolTipButton.onclick=function(e){return n()},document.testPlugin.dismissToolTipButton.onclick=function(e){return u()},document.testPlugin.showVSImageToolTipButton.onclick=function(e){return o()},document.testPlugin.showAnimatedImageToolTipButton.onclick=function(e){return i()},document.testPlugin.loadTestExtensionButton.onclick=function(e){l("testExtension",document.testPlugin.loadTestExtensionButton)},document.testPlugin.loadExtensionWithBasePathToken.onclick=function(e){l("testExtensionWithBasePathToken",document.testPlugin.loadExtensionWithBasePathToken)},document.testPlugin.loadNoSuchAliasButton.onclick=function(e){if(Microsoft.Plugin.VS.Utilities.createExternalObject("noSuchAlias","{77DB59AC-D364-4689-BF1F-DD46845F4FE2}"))throw new Error("Loading extension from 'noSuchAlias' did not fail.");Microsoft.Plugin.log("Loading extension from 'noSuchAlias' failed (expected).")},document.testPlugin.loadNonExistentFunctionality.onclick=function(e){if(Microsoft.Plugin.VS.Utilities.createExternalObject("nonExistentFunctionality","{77DB59AC-D364-4689-BF1F-DD46845F4FE2}"))throw new Error("Loading extension from 'nonExistentFunctionality' did not fail.");Microsoft.Plugin.log("Loading extension from 'nonExistentFunctionality' failed as the dll didn't exist (expected).")},document.testPlugin.loadWrongClsidButton.onclick=function(e){if(Microsoft.Plugin.VS.Utilities.createExternalObject("testExtension","{01234567-89AB-CDEF-0123-456789ABCDEF}"))throw new Error("Loading testExtension with wrong CLSID did not fail.");Microsoft.Plugin.log("Loading testExtension with wrong CLSID failed (expected).")}}),function(){function e(){var e=30123;return Microsoft.Plugin.VS.Internal.CodeMarkers.fire(e),!1}Microsoft.Plugin.VS&&Microsoft.Plugin.VS.Internal&&(window.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("vsInternalSpecificTests");e.setAttribute("style","display: block")}),window.addEventListener("DOMContentLoaded",function(){document.testPlugin.fireCodeMarkersButton.onclick=e}))}(),function(){function e(e){document.testPlugin.pubSubSubscribeButton.disabled=e,document.testPlugin.pubSubUnsubscribeButton.disabled=e,document.testPlugin.pubSubPublishButton.disabled=e}function t(){e(!0)}function n(){e(!1)}function o(){return g?Microsoft.Plugin.Promise.wrap(g):p._call("getPubSubEndpoint").then(function(e){return g=e})}function i(){return f?Microsoft.Plugin.Promise.wrap(f):(document.testPlugin.pubsubOutput.value+="Connecting to hub...\r\n",o().then(function(e){return f=new Microsoft.VSHub.PubSub(e)}))}function u(){return document.testPlugin.topicNameTextbox.value&&""!==document.testPlugin.topicNameTextbox.value?!0:(alert("You must provide a topic name to publish/subscribe/unsubscribe."),!1)}function s(){document.testPlugin.pubsubOutput.value=""}function l(e,t){document.testPlugin.pubsubOutput.value+="Received ("+e+"): "+t.toString()+"\r\n"}function r(e){return e.number===Microsoft.VSHub.PubSub.SERVER_UNREACHABLE}function c(){g=null,f=null}function a(){if(!u())return!1;var e=document.testPlugin.topicNameTextbox.value;return t(),i().then(function(t){var n=h[e]||(h[e]=[]),o=function(t,n,o){l(e,n)};return n.push(o),t.subscribe(e,o,function(){document.testPlugin.pubsubOutput.value+="Connection with hub lost\r\n"})}).then(function(){document.testPlugin.pubsubOutput.value+="Subscription succeeded\r\n"}).done(function(){n()},function(e){r(e)&&c(),document.testPlugin.pubsubOutput.value+="Subscription failed"+(e?": "+e.toString():"")+".\r\n",n()}),!1}function d(){if(!u())return!1;var e=document.testPlugin.topicNameTextbox.value,o=h[e];if(!o||0==o.length)return document.testPlugin.pubsubOutput.value+="No subscriptions exist for '"+e+"'\r\n",!1;var s=o.pop();return t(),i().then(function(t){return s?t.unsubscribe(e,s):Microsoft.Plugin.Promise.wrap(null)}).then(function(){document.testPlugin.pubsubOutput.value+="Unsubscription from '"+e+"' succeeded\r\n"}).done(function(){0===o.length&&delete h[e],n()},function(t){r(t)&&c(),o.push(s),document.testPlugin.pubsubOutput.value+="Unsubscription from '"+e+"' failed"+(t?": "+t.toString():"")+".\r\n",n()}),!1}function m(){if(!u())return!1;var e=document.testPlugin.topicNameTextbox.value;return t(),i().done(function(t){var o=document.testPlugin.messageBodyTextbox.value,i=o&&""!==o?t.publish(e,JSON.stringify(o)):t.publish(e);i.done(function(){n()},function(t){r(t)&&c(),document.testPlugin.pubsubOutput.value+="Publication to topic'"+e+"' failed"+(t?": "+t.toString():"")+".\r\n",n()}),document.testPlugin.pubsubOutput.value+="Published to '"+e+"'\r\n"}),!1}var g,f,p=Microsoft.Plugin.Utilities.JSONMarshaler.attachToPublishedObject("Plugin.PubSub"),h={};window.addEventListener("DOMContentLoaded",function(){document.testPlugin.pubSubClearOutputButton.onclick=s,document.testPlugin.pubSubSubscribeButton.onclick=a,document.testPlugin.pubSubUnsubscribeButton.onclick=d,document.testPlugin.pubSubPublishButton.onclick=m})}(),function(){function e(n,o,i,u){Microsoft.Plugin.VS.Experimental.Solution.getItems(n,o,i,u).then(function(o){if(t=t.concat(o),o.length==i)e(n,o[o.length-1].id,i,u);else{for(var s=0,l="<ul>",r=0;r<t.length;r++)s<t[r].level?(l+="<ul id='treeItemChildren"+t[r-1].id+"'>",s=t[r].level):s>t[r].level&&(l+="</ul>",s=t[r].level),l+="<li id='treeItem"+t[r].id+"'>"+t[r].name+" ("+t[r].id+")</li>";l+="</ul>",document.getElementById("solutionHierarchy").innerHTML=l}})}if(Microsoft.Plugin.VS.Experimental&&Microsoft.Plugin.VS.Experimental.Solution){var t=[];window.addEventListener("DOMContentLoaded",function(){document.testPlugin.getSolutionButton.onclick=function(){t=[],e(void 0,void 0,5,50)},document.testPlugin.getItemPropertiesButton.onclick=function(){Microsoft.Plugin.VS.Experimental.Solution.getItemProperties(document.testPlugin.itemPropertiesInput.value).then(function(e){var t="<ul>";for(var n in e){var o=e[n];"function"!=typeof o&&"prototype"!==n&&(t+="<li>"+n+" : "+o+"</li>")}t+="</ul>",document.getElementById("itemProperties").innerHTML=t})}}),Microsoft.Plugin.VS.Experimental.Solution.addEventListener("itemadded",function(e){var t=e.parentItem,n=e.item,o=e.previousSiblingItem,i=document.getElementById("treeItem"+t.id);if(i){var u=document.createElement("li");u.setAttribute("id","treeItem"+n.id),u.innerText=n.name+" ("+n.id+")";var s=document.getElementById("treeItemChildren"+t.id);if(s)if(o){var l=document.getElementById("treeItem"+o.id),r=l.nextElementSibling;r?("ul"===r.nodeName.toLowerCase()&&(r=r.nextElementSibling),r?s.insertBefore(u,r):s.appendChild(u)):s.appendChild(u)}else s.appendChild(u);else s=document.createElement("ul"),s.setAttribute("id","treeItemChildren"+t.id),s.appendChild(u),i.nextElementSibling?i.parentElement.insertBefore(s,i.nextElementSibling):i.parentElement.appendChild(s)}}),Microsoft.Plugin.VS.Experimental.Solution.addEventListener("itemdeleted",function(e){var t=e.item,n=document.getElementById("treeItem"+t.id);n&&n.parentElement.removeChild(n);var o=document.getElementById("treeItemChildren"+t.id);o&&o.parentElement.removeChild(o)}),Microsoft.Plugin.VS.Experimental.Solution.addEventListener("itemsappended",function(e){}),Microsoft.Plugin.VS.Experimental.Solution.addEventListener("iteminvalidated",function(e){}),Microsoft.Plugin.VS.Experimental.Solution.addEventListener("itempropertieschanged",function(e){})}}()}}();