/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
"use strict";define("vs/base/common/scorer",["require","exports"],function(e,t){function n(e,t,n){if(!e||!t)return 0;var i=n&&n[e+t];if("number"==typeof i)return i;for(var s=t.length,a=e.toLowerCase(),c=t.toLowerCase(),u=0,l=0,h=0;s>u;){var p=a.indexOf(c[u],l);if(0>p){h=0;break}l=p,h+=1,e[p]===t[p]&&(h+=1),r(e.charCodeAt(p))&&(h+=1),0===p&&(h+=8),o.some(function(t){return t===e[p-1]})&&(h+=7),u++}return n&&(n[e+t]=h),h}function r(e){return e>=65&&90>=e}/*!
    * string_score.js: String Scoring Algorithm 0.1.22
    *
    * http://joshaven.com/string_score
    * https://github.com/joshaven/string_score
    *
    * Copyright (C) 2009-2014 Joshaven Potter <yourtech@gmail.com>
    * Special thanks to all of the contributors listed here https://github.com/joshaven/string_score
    * MIT License: http://opensource.org/licenses/MIT
    *
    * Date: Tue Mar 1 2011
    * Updated: Tue Mar 10 2015
    */
var o=["-","_"," ","/","\\","."];t.score=n}),define("vs/nls!vs/workbench/parts/search/browser/openFileHandler",["vs/nls","vs/nls!vs/workbench/parts/search/browser/openAnythingHandler"],function(e,t){return e.create("vs/workbench/parts/search/browser/openFileHandler",t)}),define("vs/nls!vs/workbench/parts/search/browser/openSymbolHandler",["vs/nls","vs/nls!vs/workbench/parts/search/browser/openAnythingHandler"],function(e,t){return e.create("vs/workbench/parts/search/browser/openSymbolHandler",t)});var __decorate=this&&this.__decorate||function(e,t,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(e,t,n,r);switch(arguments.length){case 2:return e.reduceRight(function(e,t){return t&&t(e)||e},t);case 3:return e.reduceRight(function(e,r){return void(r&&r(t,n))},void 0);case 4:return e.reduceRight(function(e,r){return r&&r(t,n,e)||e},r)}},__param=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};define("vs/workbench/parts/search/common/searchQuery",["require","exports","vs/base/common/objects","vs/platform/search/common/search","vs/platform/configuration/common/configuration"],function(e,t,n,r,o){function i(e){var t=e&&e.files&&e.files.exclude,r=e&&e.search&&e.search.exclude;if(!t&&!r)return null;if(!t||!r)return t||r;var o=Object.create(null);return o=n.mixin(o,t),o=n.mixin(o,r,!0)}t.getExcludes=i;var s=function(){function e(e){this.configurationService=e}return e.prototype.text=function(e,t){return this.query(r.QueryType.Text,e,t)},e.prototype.file=function(e){return this.query(r.QueryType.File,null,e)},e.prototype.query=function(e,t,r){return void 0===r&&(r={}),this.configurationService.loadConfiguration().then(function(o){var s=i(o);return r.excludePattern?n.mixin(r.excludePattern,s,!1):r.excludePattern=s,{type:e,rootResources:r.rootResources,filePattern:r.filePattern,excludePattern:r.excludePattern,includePattern:r.includePattern,maxResults:r.maxResults,fileEncoding:r.fileEncoding,contentPattern:t,matchFuzzy:r.matchFuzzy}})},e=__decorate([__param(0,o.IConfigurationService)],e)}();t.QueryBuilder=s});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__decorate=this&&this.__decorate||function(e,t,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(e,t,n,r);switch(arguments.length){case 2:return e.reduceRight(function(e,t){return t&&t(e)||e},t);case 3:return e.reduceRight(function(e,r){return void(r&&r(t,n))},void 0);case 4:return e.reduceRight(function(e,r){return r&&r(t,n,e)||e},r)}},__param=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};define("vs/workbench/parts/search/browser/openFileHandler",["require","exports","vs/base/common/winjs.base","vs/nls!vs/workbench/parts/search/browser/openFileHandler","vs/base/common/async","vs/base/common/paths","vs/base/common/labels","vs/base/parts/quickopen/browser/quickOpenModel","vs/workbench/browser/quickopen","vs/workbench/parts/search/common/searchQuery","vs/workbench/parts/files/common/files","vs/workbench/services/editor/common/editorService","vs/platform/configuration/common/configuration","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/platform/search/common/search","vs/platform/workspace/common/workspace"],function(e,t,n,r,o,i,s,a,c,u,l,h,p,f,d,m,v){var g=function(e){function t(t,n,r,o,i,s){e.call(this,o),this.instantiationService=i,this.resource=r,this.name=t,this.description=n}return __extends(t,e),t.prototype.getLabel=function(){return this.name},t.prototype.getDescription=function(){return this.description},t.prototype.getIcon=function(){return"file"},t.prototype.getResource=function(){return this.resource},t.prototype.setRange=function(e){this.range=e},t.prototype.getInput=function(){var e={resource:this.resource};return this.range&&(e.options={selection:this.range}),e},t=__decorate([__param(3,h.IWorkbenchEditorService),__param(4,f.IInstantiationService),__param(5,v.IWorkspaceContextService)],t)}(c.EditorQuickOpenEntry);t.FileEntry=g;var y=function(e){function t(n,r,i,s,a,c,l){e.call(this),this.editorService=n,this.messageService=r,this.instantiationService=i,this.configurationService=s,this.contextService=a,this.textFileService=c,this.searchService=l,this.queryBuilder=this.instantiationService.createInstance(u.QueryBuilder),this.delayer=new o.ThrottledDelayer(t.SEARCH_DELAY),this.isStandalone=!0}return __extends(t,e),t.prototype.setStandalone=function(e){this.delayer=e?new o.ThrottledDelayer(t.SEARCH_DELAY):null,this.isStandalone=e},t.prototype.setFuzzyMatchingEnabled=function(e){this.fuzzyMatchingEnabled=e},t.prototype.getResults=function(e){var t=this;e=e.trim();var r;return r=e?this.delayer?this.delayer.trigger(function(){return t.doFindResults(e)}):this.doFindResults(e):n.TPromise.as([]),r.then(function(e){return new a.QuickOpenModel(e)})},t.prototype.doFindResults=function(e){var t=this,n=this.textFileService.getWorkingFilesModel().getOutOfWorkspaceContextEntries().map(function(e){return e.resource});this.contextService.getWorkspace()&&n.push(this.contextService.getWorkspace().resource);var r={filePattern:e,matchFuzzy:this.fuzzyMatchingEnabled,rootResources:n};return this.queryBuilder.file(r).then(function(e){return t.searchService.search(e)}).then(function(n){for(var r=[],o=0;o<n.results.length;o++){var c=n.results[o],u=i.basename(c.resource.fsPath),l=s.getPathLabel(i.dirname(c.resource.fsPath),t.contextService),h=t.instantiationService.createInstance(g,u,l,c.resource),p=a.QuickOpenEntry.highlight(h,e,t.fuzzyMatchingEnabled),f=p.labelHighlights,d=p.descriptionHighlights;h.setHighlights(f,d),r.push(h)}return t.isStandalone&&(r=r.sort(function(t,n){return a.QuickOpenEntry.compare(t,n,e)})),r})},t.prototype.getGroupLabel=function(){return r.localize(0,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0}},t.SEARCH_DELAY=500,t=__decorate([__param(0,h.IWorkbenchEditorService),__param(1,d.IMessageService),__param(2,f.IInstantiationService),__param(3,p.IConfigurationService),__param(4,v.IWorkspaceContextService),__param(5,l.ITextFileService),__param(6,m.ISearchService)],t)}(c.QuickOpenHandler);t.OpenFileHandler=y});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__decorate=this&&this.__decorate||function(e,t,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(e,t,n,r);switch(arguments.length){case 2:return e.reduceRight(function(e,t){return t&&t(e)||e},t);case 3:return e.reduceRight(function(e,r){return void(r&&r(t,n))},void 0);case 4:return e.reduceRight(function(e,r){return r&&r(t,n,e)||e},r)}},__param=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};define("vs/workbench/parts/search/browser/openSymbolHandler",["require","exports","vs/base/common/winjs.base","vs/nls!vs/workbench/parts/search/browser/openSymbolHandler","vs/base/common/async","vs/workbench/browser/quickopen","vs/base/parts/quickopen/browser/quickOpenModel","vs/base/common/filters","vs/base/common/labels","vs/workbench/services/editor/common/editorService","vs/platform/instantiation/common/instantiation","vs/platform/workspace/common/workspace","vs/editor/common/services/modeService","../common/search"],function(e,t,n,r,o,i,s,a,c,u,l,h,p,f){var d=function(e){function t(t,n,r,o,i,s,a,c){e.call(this,c),this.name=t,this.parameters=n,this.description=r,this.resource=o,this.type=i,this.range=s,this.setHighlights(a)}return __extends(t,e),t.prototype.getLabel=function(){return this.name+this.parameters},t.prototype.getName=function(){return this.name},t.prototype.getParameters=function(){return this.parameters},t.prototype.getDescription=function(){return this.description},t.prototype.getType=function(){return this.type},t.prototype.getIcon=function(){return this.type},t.prototype.getInput=function(){var e={resource:this.resource};return this.range&&(e.options={selection:{startLineNumber:this.range.startLineNumber,startColumn:this.range.startColumn}}),e},t}(i.EditorQuickOpenEntry),m=function(e){function t(n,r,i,s){e.call(this),this.editorService=n,this.modeService=r,this.instantiationService=i,this.contextService=s,this.delayer=new o.ThrottledDelayer(t.SEARCH_DELAY),this.isStandalone=!0}return __extends(t,e),t.prototype.setStandalone=function(e){this.delayer=e?new o.ThrottledDelayer(t.SEARCH_DELAY):null,this.isStandalone=e},t.prototype.canRun=function(){return!0},t.prototype.getResults=function(e){var t=this;e=e.trim();var r;return r=e?this.delayer?this.delayer.trigger(function(){return t.doGetResults(e)}):this.doGetResults(e):n.TPromise.as([]),r.then(function(e){return new s.QuickOpenModel(e)})},t.prototype.doGetResults=function(e){var t=this;return f.getNavigateToItems(e).then(function(n){return t.toQuickOpenEntries(n,e)})},t.prototype.toQuickOpenEntries=function(e,n){var r=this,o=[];return e.forEach(function(e){if(t.SUPPORTED_OPEN_TYPES.some(function(t){return e.type===t})){var i=a.matchesFuzzy(n,e.name);if(i){var s=e.resourceUri;if("file"===s.scheme){var u=c.getPathLabel(s,r.contextService),l=void 0;l=e.containerName===u?u:e.containerName===s.toString()&&e.containerName.indexOf("/")>=0?e.containerName.substr(e.containerName.lastIndexOf("/")+1):e.containerName&&e.containerName.indexOf(".")>=0?e.containerName.substr(e.containerName.lastIndexOf(".")+1):e.containerName||u,o.push(new d(e.name,e.parameters,l,s,e.type,e.range,i,r.editorService))}}}}),this.isStandalone?o.sort(this.sort.bind(this,n.toLowerCase())):o},t.prototype.sort=function(e,n,r){var o=n.getName().toLowerCase(),i=r.getName().toLowerCase();if(o===i){var a=n.getType(),c=r.getType();if(a!==c)return t.SUPPORTED_OPEN_TYPES.indexOf(a)<t.SUPPORTED_OPEN_TYPES.indexOf(c)?-1:1}return s.QuickOpenEntry.compare(n,r,e)},t.prototype.getGroupLabel=function(){return r.localize(0,null)},t.prototype.getEmptyLabel=function(e){return e.length>0?r.localize(1,null):r.localize(2,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0,autoFocusPrefixMatch:e.trim()}},t.SUPPORTED_OPEN_TYPES=["class","interface","enum","function","method"],t.SEARCH_DELAY=500,t=__decorate([__param(0,u.IWorkbenchEditorService),__param(1,p.IModeService),__param(2,l.IInstantiationService),__param(3,h.IWorkspaceContextService)],t)}(i.QuickOpenHandler);t.OpenSymbolHandler=m});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__decorate=this&&this.__decorate||function(e,t,n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(e,t,n,r);switch(arguments.length){case 2:return e.reduceRight(function(e,t){return t&&t(e)||e},t);case 3:return e.reduceRight(function(e,r){return void(r&&r(t,n))},void 0);case 4:return e.reduceRight(function(e,r){return r&&r(t,n,e)||e},r)}},__param=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};define("vs/workbench/parts/search/browser/openAnythingHandler",["require","exports","vs/base/common/winjs.base","vs/nls!vs/workbench/parts/search/browser/openAnythingHandler","vs/base/common/async","vs/base/common/types","vs/base/common/scorer","vs/base/common/paths","vs/base/common/filters","vs/base/common/labels","vs/base/parts/quickopen/browser/quickOpenModel","vs/workbench/browser/quickopen","vs/workbench/parts/search/browser/openFileHandler","vs/workbench/parts/search/browser/openSymbolHandler","vs/platform/message/common/message","vs/platform/instantiation/common/instantiation","vs/workbench/services/workspace/common/contextService","vs/platform/configuration/common/configuration"],function(e,t,n,r,o,i,s,a,c,u,l,h,p,f,d,m,v,g){t.OpenSymbolHandler=f.OpenSymbolHandler;var y=function(e){function t(n,r,i,s){e.call(this),this.messageService=n,this.contextService=r,this.configurationService=s,this.openSymbolHandler=i.createInstance(f.OpenSymbolHandler),this.openFileHandler=i.createInstance(p.OpenFileHandler),this.openSymbolHandler.setStandalone(!1),this.openFileHandler.setStandalone(!1),this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null),this.delayer=new o.ThrottledDelayer(t.SEARCH_DELAY),this.updateFuzzyMatching(r.getOptions().globalSettings.settings),this.registerListeners()}return __extends(t,e),t.prototype.registerListeners=function(){var e=this;this.configurationListenerUnbind=this.configurationService.addListener(g.ConfigurationServiceEventTypes.UPDATED,function(t){return e.updateFuzzyMatching(t.config)})},t.prototype.updateFuzzyMatching=function(e){this.fuzzyMatchingEnabled=e.filePicker&&e.filePicker.alternateFileNameMatching,this.openFileHandler.setFuzzyMatchingEnabled(this.fuzzyMatchingEnabled)},t.prototype.getResults=function(e){var r=this;if(e=e.trim(),this.cancelPendingSearch(),this.isClosed=!1,!e)return n.TPromise.as(new l.QuickOpenModel);var o=this.findRange(e);if(o){var i=e.indexOf("#")>=0?e.indexOf("#"):e.indexOf(":");i>=0&&(e=e.substring(0,i))}var s=this.getResultsFromCache(e,o);if(s)return n.TPromise.as(new l.QuickOpenModel(s));var a=function(){var i=!1,s=[];if(o)s.push(n.Promise.as(new l.QuickOpenModel));else{var a=function(e){return n.TPromise.timeout(e).then(function(){return i?n.Promise.as(new l.QuickOpenModel):a(t.SYMBOL_SEARCH_SUBSEQUENT_TIMEOUT)})},c=r.openSymbolHandler.getResults(e),u=a(t.SYMBOL_SEARCH_INITIAL_TIMEOUT);s.push(n.Promise.any([c,u]).then(function(e){return e.value}))}return s.push(r.openFileHandler.getResults(e).then(function(e){return i=!0,e})),r.pendingSearch=n.TPromise.join(s).then(function(i){if(r.pendingSearch=null,r.isClosed)return n.TPromise.as(new l.QuickOpenModel);var s=i[0].entries.concat(i[1].entries);s.sort(function(t,n){return r.sort(t,n,e,r.fuzzyMatchingEnabled)}),s.forEach(function(e){e instanceof p.FileEntry&&e.setRange(o)}),r.resultsToSearchCache[e]=s;var a=s.length>t.MAX_DISPLAYED_RESULTS?s.slice(0,t.MAX_DISPLAYED_RESULTS):s;return n.TPromise.as(new l.QuickOpenModel(a))},function(e){r.pendingSearch=null,r.messageService.show(d.Severity.Error,e)}),r.pendingSearch};return this.delayer.trigger(a)},t.prototype.findRange=function(e){var n=null,r=t.LINE_COLON_PATTERN.exec(e);if(r&&r.length>1){var o=parseInt(r[1],10);if(i.isNumber(o)){if(n={startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1},r.length>3){var s=parseInt(r[3],10);i.isNumber(s)&&(n.startColumn=s,n.endColumn=s)}}else""===r[1]&&(n={startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1})}return n},t.prototype.getResultsFromCache=function(e,n){var r=this;void 0===n&&(n=null);var o;for(var i in this.resultsToSearchCache)if(0===e.indexOf(i)){if(e.indexOf(a.nativeSep)>=0&&i.indexOf(a.nativeSep)<0)continue;o=this.resultsToSearchCache[i];break}if(!o)return null;for(var s=[],h=this.fuzzyMatchingEnabled||e.indexOf(a.nativeSep)>=0,f=0;f<o.length;f++){var d=o[f];if(!n||d instanceof p.FileEntry){var m=d.getResource(),v=h&&m?u.getPathLabel(m,this.contextService):d.getLabel();if(c.matchesFuzzy(e,v,this.fuzzyMatchingEnabled)){var g=l.QuickOpenEntry.highlight(d,e,this.fuzzyMatchingEnabled),y=g.labelHighlights,_=g.descriptionHighlights;d.setHighlights(y,_),s.push(d)}}}s.sort(function(t,n){return r.sort(t,n,e,r.fuzzyMatchingEnabled)}),s.forEach(function(e){e instanceof p.FileEntry&&e.setRange(n)});var b=s.length>t.MAX_DISPLAYED_RESULTS?s.slice(0,t.MAX_DISPLAYED_RESULTS):s;return b},t.prototype.sort=function(e,t,n,r){if(r){var o=s.score(e.getLabel(),n,this.scorerCache),i=s.score(t.getLabel(),n,this.scorerCache);if(o!==i)return o>i?-1:1;var a=e.getResource(),c=t.getResource();if(a&&c){var u=s.score(a.fsPath,n,this.scorerCache),h=s.score(c.fsPath,n,this.scorerCache);if(u!==h)return u>h?-1:1}}return l.QuickOpenEntry.compare(e,t,n)},t.prototype.getGroupLabel=function(){return r.localize(0,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0}},t.prototype.onClose=function(e){this.isClosed=!0,this.cancelPendingSearch(),this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null),this.openSymbolHandler.onClose(e),this.openFileHandler.onClose(e)},t.prototype.cancelPendingSearch=function(){this.pendingSearch&&(this.pendingSearch.cancel(),this.pendingSearch=null)},t.LINE_COLON_PATTERN=/[#|:](\d*)([#|:](\d*))?$/,t.SYMBOL_SEARCH_INITIAL_TIMEOUT=500,t.SYMBOL_SEARCH_SUBSEQUENT_TIMEOUT=100,t.SEARCH_DELAY=300,t.MAX_DISPLAYED_RESULTS=1024,t=__decorate([__param(0,d.IMessageService),__param(1,v.IWorkspaceContextService),__param(2,m.IInstantiationService),__param(3,g.IConfigurationService)],t)}(h.QuickOpenHandler);t.OpenAnythingHandler=y});