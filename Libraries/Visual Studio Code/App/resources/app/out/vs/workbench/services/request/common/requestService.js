"use strict";var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};define("vs/workbench/services/request/common/requestService",["require","exports","vs/base/common/winjs.base","vs/base/common/timer","vs/base/common/async","vs/base/common/strings","vs/nls!vs/workbench/services/request/common/requestService","vs/platform/request/common/baseRequestService"],function(e,t,r,s,n,i,o,u){var c=function(e){function t(t){e.call(this,t),this._threadService=t.threadService,t.threadService.registerInstance(this)}return __extends(t,e),t.prototype.getId=function(){return"NativeRequestService"},t.prototype.makeRequest=function(t){var s=t.url;if(!s)throw new Error("IRequestService.makeRequest: Url is required");return i.startsWith(s,"file://")?r.xhr(t).then(null,function(e){return 0===e.status&&e.responseText?e:r.Promise.wrapError(new Error(o.localize(0,null)))}):e.prototype.makeRequest.call(this,t)},t.prototype.makeCrossOriginRequest=function(e){if(this._nodeJSXHRFunctionPromise){var t=s.nullEvent;return this._telemetryService&&(t=this._telemetryService.start("WorkerXHR",{url:e.url},!1)),this._nodeJSXHRFunctionPromise.then(function(r){return n.always(r(e),function(e){t.data&&(t.data.status=e.status),t.stop()})})}return this._threadService.MainThread(this,"makeCrossOriginRequest",null,[e])},t}(u.BaseRequestService);t.WorkerRequestService=c});